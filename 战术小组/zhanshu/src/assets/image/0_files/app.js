webpackJsonp([0],[,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.trans=void 0;var r=n(71),o={},a={},i="zh_CN",u={},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u=_.assign({},u,e)},l=function(){return u},c=function(e,t){"string"==typeof e&&e&&("function"==typeof t&&(t=t.call(null)),$.isPlainObject(t)&&(a[e]=$.extend(!0,f(e),t)))},f=function(e){return void 0===e?a:a[e]||{}},d=function(e){if("string"!=typeof e||!e)return i;if(i!==e&&-1!==_.indexOf(y(),e)){var t=i;i=e,$(o).trigger("change",[t,e])}},p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e||"string"!=typeof e)throw new TypeError("Translate failed, the key must be a string.");var n=f(i),o=(0,r.getValue)(n,e);return"string"!=typeof o?e:(t=_.assign({},u,t),_.template(o)(t))},y=function(){return _.keys(a)},m=function(){return i};o.setTempData=s,o.getTempData=l,o.register=c,o.current=m,o.detail=f,o.trans=p,o.use=d,t.trans=p,t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.cmd=t.system=t.session=t.storage=t.base=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(71),u=o(i),s=n(337),l=r(s),c=n(338),f=r(c),d=n(339),p=o(d),y=n(350),m=r(y);t.base=u,t.storage=l.default,t.session=f.default,t.system=p,t.cmd=m.default,t.default=a({},u,{storage:l.default,session:f.default,system:p,cmd:m.default})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(71),o=n(217),a={emojis:o.emojis,im:{},hosts:{},global:{},recommendPosts:[],selectAgentGroup:{},inServiceTime:!0,ticketCSRF:$("meta[name=_csrf]").attr("value")};"function"==typeof window.globalConfig&&(a.global=window.globalConfig.call(null)||{}),_.assign(a,n(218));var i=function e(t,n){return e.get(t,n)};i.get=function(e,t){return e?(0,r.getValue)(a,e,t):a},i.set=_.bind(r.setValue,null,a),t.default=i},,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=t.message=t.company=t.visitor=t.agent=t.chat=t.id=void 0;var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r),a=n(29),i=o.default.PropTypes;t.id=i.oneOfType([i.string,i.number]),t.chat=i.shape({id:i.number,type:i.string,status:i.string,created:i.number}),t.agent=i.shape({id:i.number,role:i.string,display_name:i.string,name:i.string,photo:i.string,intro:i.string,email:i.string,max_serve:i.number,typing:i.bool,created:i.number}),t.visitor=i.shape({id:i.number,vid:i.string,display_name:i.string,name:i.string,photo:i.string,email:i.string,created:i.number}),t.company=i.shape({id:i.number,display_name:i.string,name:i.string,photo:i.string,intro:i.string}),t.message=i.instanceOf(a.Map),t.messages=i.instanceOf(a.List)},,function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=n(342),i=r(a),u=n(344),s=r(u);t.default=o({},i,s)},,,,,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),f=r(c),d=n(36),p=(r(d),n(2)),y=n(16),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(y),g=n(65),h=r(g),v=(s=u=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),l(t,[{key:"shouldComponentUpdate",value:function(e){return!_.isEqual(this.props,e)}},{key:"progressMap",value:function(){return{initial:null,sending:f.default.createElement(h.default,{size:"sm"}),success:null,failed:(0,p.trans)("sendFailure")}}},{key:"children",value:function(){return this.props.children}},{key:"render",value:function(){var e=this.props,t=this.progressMap()[e.status],n=e.own&&t,r="failed"===e.status?f.default.createElement("span",{className:"chat-msg-wrong"},t):t;return f.default.createElement("div",{id:e.id,className:e.className},this.children(),n&&f.default.createElement("div",{className:"chat-msg-progress"},r))}}]),t}(f.default.Component),u.defaultProps={className:"chat-msg-text",status:"initial"},u.propTypes={id:m.id.isRequired,own:f.default.PropTypes.bool,className:f.default.PropTypes.string,status:f.default.PropTypes.oneOf(["initial","sending","success","failed"]).isRequired,error:f.default.PropTypes.string},s);t.default=v},,,,,,,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(60),a=n(155),i=r(a),u=n(336),s=r(u),l=n(351),c=window._INITIAL_STATE_||{},f=function(){return d},d=(0,o.createStore)(s.default,c,(0,o.compose)((0,o.applyMiddleware)(i.default.withExtraArgument(f)),(0,l.enhanceEvent)()));t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(29),o=n(4),a=function(e){return e&&e.__esModule?e:{default:e}}(o);t.default={chat:null,agent:null,user:null,company:null,app:{session:null,lang:(0,a.default)("global.lang","zh_CN"),canStart:!1,toast:null,bellEnabled:!0,newMsgCount:0,boxOpened:!1,emojis:(0,a.default)("emojis",[]).slice(0,12).map(function(e){return[e,0]}),timeoutMsg:null,users:[],visitingCard:{}},messages:r.List.of()}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e){if(e)return"string"==typeof e?e:e.errors&&e.errors.length?e.errors[0].message||e.errors[0].error:e.error?e.error:e.toString?e.toString():void 0}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=n(18),s=r(u),l=n(3),c=r(l),f=n(4),d=r(f),p=(n(2),n(92)),y=r(p),m=n(167),g=n(168),h={component:null,status:null,sender:null,file:null,text:null,src:null,fileName:null,fileSize:null,documents:null,questions:null,datetime:null},v={id:null,offset:0,index:null,indexInGroup:null},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:m.Types.ADD_MESSAGE,payload:$.extend({},h,e),position:$.extend({},v,t)}},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.text,n=e.file,r=e.question,o=e.category,a=e.recalled;"string"==typeof e?t=e:c.default.isFile(e)&&(n=e);var i=y.default.getMessageComponentName({text:t,file:n}),u=null,s=null;return"File"!==i&&"Image"!==i||(u=n.name,s=n.size),b({id:y.default.getNewId(),component:i,status:"sending",sender:null,datetime:c.default.now(),file:n,text:t,question:r,category:o,fileName:u,fileSize:s,recalled:a})},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=_(e),n=t.payload,r=n.id,o=n.component,i=n.file,u=n.text,l=n.question,f=n.category,p=(0,d.default)("global.forum_ids"),y=(0,d.default)("global.category_ids");return function(e,n,m){var g=n(),h=g.user,v=g.chat;if(t.payload.sender=h.id,e(t),c.default.readDataUrlOfImage(i).then(function(t){t&&e(T(r,{src:t}))}),!v&&2===(0,d.default)("global.self_service_type"))return e(E(t.payload));v||e(T(r,{status:"success"}));var b=function(){var t=n(),c=t.agent,d=t.chat,m=null;if("Text"===o)m=l&&c&&"robot"===c.role?s.default.sendQuestionMessage(d.id,r,l,y,p):f&&c&&"robot"===c.role?s.default.sendCategoryMessage(d.id,r,f):s.default.sendTextMessage(d.id,r,u.toString(),y,p);else{if("Image"!==o&&"File"!==o)return;m=s.default.uploadFile(i).then(function(e){var t=e&&e.data,n=t.token;t.type,t.url;return s.default.sendFileMessage(d.id,r,n,y,p)})}m.then(function(t){var n={status:"success"};t&&t.message&&t.message.upload&&t.message.upload.url&&(n.src=t.message.upload.url),e(T(r,n))}).catch(function(t){e(T(r,{status:"failed",error:a(t)})),"Image"!==o&&"File"!==o&&e(P(r))})};if(v)return b();m().once(function(e,t){return t.chat},b)}},E=function(e){var t=e.id,n=e.text,r=e.component;return function(e){s.default.search(n).then(function(n){e(T(t,{status:"success"})),e(R({title:"searchResult.title",documents:n}))}).catch(function(n){e(T(t,{status:"failed"})),"Image"!==r&&e(P(t))})}},O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=t.id,a=t.customId,i=t.datetime,u=t.type,s=t.text,l=t.src,f=t.fileName,d=t.fileSize,p=t.documents,m=t.questions,g=t.videoMeeting,h=t.hotCategories,v=t.recalled,_=y.default.getMessageComponentName(t);return function(w,E){var O=E(),M=O.messages;if(a){if("number"==typeof y.default.getIndexList(M,{id:a})[1])return}else if("number"==typeof y.default.getIndexList(M,{id:o})[1])return void w(T(o,t));w(b({id:o||y.default.getNewId(),type:u,component:_,status:"success",sender:e,datetime:i||c.default.now(),text:s,src:l,fileName:f,fileSize:d,documents:p,questions:m,videoMeeting:g,hotCategories:h,recalled:v},n)),r&&(c.default.system.ringBell("newMessage"),c.default.isTabHidden()&&c.default.system.desktopNotifyMessage(t))}},T=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=$.extend({},v,{id:e}),r=$.extend({},h,t);return{type:m.Types.UPDATE_MESSAGE,position:n,payload:r}},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=e.id,r=e.type,a=e.datetime,i=e.data,u=void 0===i?{}:i,s=o(e,["id","type","datetime","data"]);return"number"!=typeof a&&(a=c.default.now()),u=$.extend({},u,s),{type:m.Types.ADD_NOTICE,position:$.extend({},v,t),payload:{id:n,type:r,datetime:a,data:u}}},P=function(e){return function(t,n){var r=n(),o=r.messages,a=y.default.getIndexList(o,{id:e}),u=i(a,1),s=u[0],l=o.get(s+1);if(l&&y.default.isGroup(l)){if(-1!==l.get("list").findIndex(function(e){return e&&"Notice"===e.get("component")&&e.get("type")===g.Types.RESEND}))return}var c=o.get(s);t(M({type:g.Types.RESEND,datetime:c.get("datetime")},{index:s+1}))}},S=function(e){return M({type:g.Types.YOUR_AGENT,agent:e})},j=function(e){return M({type:g.Types.ENQUEUE_SUCCESS,number:e})},C=function(e){return M({type:g.Types.ENQUEUE_TIMEOUT,msg:e})},k=function(e){return M("chatting"===e?{type:g.Types.CHATTING}:{type:g.Types.ENQUEUE_FAILED,reason:e})},x=function(){return M({type:g.Types.OFFLINE})},N=function(e){return M({type:g.Types.QUEUE_PROGRESS,number:e})},A=function(){return M({type:g.Types.AGENT_ASSIGN_FAILED})},I=function(){return M({type:g.Types.BANNED})},D=function(){return M({type:g.Types.LOAD_MORE,datetime:-1},{index:0})},F=function(e,t){return{type:m.Types.ADD_EVALUATE_CARD,position:$.extend({},v,t),payload:{chatId:e,datetime:c.default.now()}}},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=e.datetime;return n="number"==typeof n?n:c.default.now(),{type:m.Types.ADD_POST_CARD,position:$.extend({},v,t),payload:{title:e.title,url:e.url,cover:e.cover,content:e.content,datetime:n}}},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=e.datetime;return n="number"==typeof n?n:c.default.now(),{type:m.Types.ADD_DOCUMENTS_CARD,position:$.extend({},v,t),payload:{datetime:n,title:e.title,documents:e.documents}}},U=function(e){return{type:m.Types.REMOVE_FROM_MESSAGES,position:$.extend({},v,e)}},B=function(e){return{type:m.Types.RESET_MESSAGES,payload:e}},q=function(){return{type:m.Types.CLEAR_MESSAGES}};t.default={addNotice:M,pushAgentName:S,pushEnqueueSuccess:j,pushEnqueueTimeout:C,pushEnqueueFailed:k,pushEnqueueFailedOffline:x,pushQueueProgress:N,pushAgentAssignFailed:A,pushBanned:I,unshiftLoadMore:D,sendMessage:w,receiveMessage:O,updateMessage:T,addEvaluateCard:F,addPostCard:L,addDocumentsCard:R,remove:U,reset:B,clear:q}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.history=void 0;var o=n(0),a=r(o),i=n(62),u=n(377),s=r(u),l=n(400),c=r(l),f=n(431),d=r(f),p=n(436),y=r(p);t.history=i.hashHistory;t.default=a.default.createElement(i.Router,{history:i.hashHistory},a.default.createElement(i.Route,{path:"/",component:s.default},a.default.createElement(i.Route,{path:"chatbox",component:c.default}),a.default.createElement(i.Route,{path:"groups",component:d.default}),a.default.createElement(i.Route,{path:"message",component:y.default}),a.default.createElement(i.Redirect,{from:"*",to:"/message"})))},,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),i=n(2),u=n(4),s=r(u),l=n(101),c=(0,s.default)("global.livechat");t.default=function(e){return a.default.createElement("p",null,(0,i.trans)("notSolveProblem"),c?[a.default.createElement("a",{onClick:l.transferAgent}," ",(0,i.trans)("transferToAgent")," "),(0,i.trans)("or")]:"",a.default.createElement("a",{onClick:l.leaveMessage,href:"javascript:;"}," ",(0,i.trans)("leaveMessage")," "))}},,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(156),o=function(){return{type:r.Types.ENABLE_BELL}},a=function(){return{type:r.Types.DISABLE_BELL}},i=function(e){return{type:r.Types.CHANGE_LANG,payload:e}},u=function(e){return{type:r.Types.TOAST_NOTICE,payload:e}},s=function(){return{type:r.Types.CAN_START}},l=function(){return{type:r.Types.INC_NEW_MSG_COUNT}},c=function(){return{type:r.Types.CLEAR_NEW_MSG_COUNT}},f=function(){return{type:r.Types.OPEN_BOX}},d=function(){return{type:r.Types.CLOSE_BOX}},p=function(e){return function(t,n){for(var o=n().app.emojis.slice(),a=o.length-1,i=o.length,u=!1;i&&!u;){var s=o[--i];s[0]===e&&(o[i]=[e,s[1]+1],u=!0)}!u&&o[a][1]<=1&&(o[a]=[e,1]),t({type:r.Types.EMOJIS,payload:o.sort(function(e,t){return t[1]-e[1]})})}},y=function(e){return{type:r.Types.TIMEOUT_MSG,payload:e}},m=function(e){return function(t,n){var o=_.assign({},n().app.users);e&&(o[e.id]=e,t({type:r.Types.USERS,payload:o}))}},g=function(e){return{type:r.Types.VISITING_CARD,payload:e}},h=function(e){return{type:r.Types.SET_SESSION,payload:e}};t.default={enableBell:o,disableBell:a,changeLang:i,toastNotice:u,canStart:s,incNewMsgCount:l,clearNewMsgCount:c,openBox:f,closeBox:d,usedEmoji:p,setTimeoutMsg:y,stashUser:m,setVisitingCard:g,setSession:h}},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r),a=function(e){var t=e.size,n=e.center,r=e.zIndex;return o.default.createElement("div",{style:{zIndex:r},className:"loading loading-"+t+(n?" center":"")})};a.defaultProps={size:"md",center:!1,zIndex:1e3},a.propTypes={size:o.default.PropTypes.oneOf(["lg","md","sm","xs"]),center:o.default.PropTypes.bool,zIndex:o.default.PropTypes.number},t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(0),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=n(16),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i),s=function(e){return a.default.createElement("div",r({id:e.id},{className:"chat-card"}),e.title&&a.default.createElement("div",{className:"chat-card_head"},a.default.createElement("h3",null,e.title),e.hint&&a.default.createElement("p",{className:"hint",dangerouslySetInnerHTML:{__html:e.hint}})),e.children)};s.propTypes={id:u.id,title:a.default.PropTypes.oneOfType([a.default.PropTypes.string,a.default.PropTypes.element]),hint:a.default.PropTypes.string},s.Body=function(e){return a.default.createElement("div",{className:"chat-card_body"},e.children)},s.Foot=function(e){return a.default.createElement("div",{className:"chat-card_foot"},e.children)},t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r),a=function(e){return o.default.createElement("div",{className:"form_item"},o.default.createElement("div",{className:"form_item_title"},o.default.createElement("label",null,e.title),e.required&&o.default.createElement("span",{className:"important"},"*")),e.children)};a.defaultProps={required:!1},a.propsTypes={title:o.default.PropTypes.string,required:o.default.PropTypes.bool},t.default=a},,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.responsibilityPatton=t.desktopNotify=t.isTabHidden=t.addParamsToUrl=t.addHostToUrl=t.replaceURLToLink=t.safeText=t.replaceURL=t.analysisMsg=t.getBrowserName=t.getSearchEngine=t.postToParent=t.inIFrame=t.getRandomItem=t.readDataUrlOfImage=t.showFileSize=t.isImageUrl=t.isImage=t.isFile=t.isBlob=t.toCamelCase=t.setValue=t.getValue=t.stringify=t.parseJSON=t.toMinutes=t.now=t.noop=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=n(110),i=r(a),u=n(111),s=r(u),l=window._,c=window.$,f=window.File,d=window.Blob,p=window.FileReader,y={URL:/(?:http|https|ftp):\/\/(?:[\w\.-]+)+\.[a-z]{2,6}(?:\:\d{1,5})?(?:\/[-a-z0-9_%\.]*)*(?:\?[^\u00ff-\uffff\s]*)?(?:#[^\u00ff-\uffff\s]*)?/gi},m=(t.noop=function(){},t.now=function(){return l.now()},t.toMinutes=function(e){return Math.floor(e/6e4)},t.parseJSON=function(e){try{return c.parseJSON(e)}catch(e){}},t.stringify=function(e){return JSON.stringify(e)},t.getValue=function(e,t,n){if(!t||"string"!=typeof t)return n;var r=(0,i.default)(e,t),a=void 0===r?"undefined":o(r);return"number"===a||"boolean"===a?r:void 0===n?r:r||n},t.setValue=function(e,t,n){t&&"string"==typeof t&&(0,s.default)(e,t,n)},t.toCamelCase=function(e){return l.camelCase(e)},t.isBlob=function(e){return!!(d&&e instanceof d)},t.isFile=function(e){return!!(f&&e instanceof f)}),g=t.isImage=function(e){return!!m(e)&&0===e.type.indexOf("image")},h=(t.isImageUrl=function(e){var t=!1;return e&&"string"==typeof e?(l.each(["jpg","jpeg","png","bmp","gif"],function(n){-1!==e.indexOf("."+n)&&(t=!0)}),t):t},t.showFileSize=function(e){if("string"==typeof e)return e;if("number"!=typeof e)return"";var t=e/1024;return t<1024?t.toFixed(2)+"KB":(t/1024).toFixed(2)+"MB"},t.readDataUrlOfImage=function(e){if(!p||!g(e))return Promise.resolve(null);var t=new p,n=new Promise(function(e,n){c(t).on("load",function(){e(t.result)}),c(t).on("error",function(){n(t.error)})});return t.readAsDataURL(e),n},t.getRandomItem=function(e){if(c.isArray(e)&&e.length){return e[l.random(0,e.length-1)]}},t.inIFrame=function(){var e=!0;try{e=window!==window.parent}catch(e){}return e},t.postToParent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*";window.parent.postMessage(e,t)},t.getSearchEngine=function(e){e=e&&e.split("//")[1];var t=e&&e.split("/")[0]||"",n=/baidu|sogou|google|so\.com|yahoo|soso|xunlei/i,r=t&&t.match(n);return r?r[0]:""},t.getBrowserName=function(){var e="netscape",t=navigator.userAgent.toLowerCase();if(/(msie|firefox|opera|chrome|netscape)\D+(\d[\d.*])/.test(t)){var n=RegExp.$1,r=l.parseInt(RegExp.$2);e=n,"msie"===n&&(e+=" "+r)}else/version\D+(\d[\d.]*).*safari/.test(t)&&(e="safari");return e},t.analysisMsg=function(e){var t=y.URL;return e=v(e),t.test(e)&&(e=b(e)),e},t.replaceURL=function(e){try{e=encodeURI(decodeURI(e))}catch(e){}return'<a href="'+e+'" target="_blank">'+e+"</a>"}),v=t.safeText=function(e){var t=document.createElement("div"),n="";return t.innerText=e,n=t.innerHTML,n.replace(/<br ?\\?>/gi,"\n")},b=t.replaceURLToLink=function(e){var t,n=y.URL,r=0,o="",a="",i="";for(n.lastIndex=0;r<e.length;)o="",a="",t=n.exec(e),t?(a=e.slice(r,t.index),o=t[0],r=t.index+o.length):(a=e.slice(r),r=e.length),i+=a,o&&(i+=h(o));return i};t.addHostToUrl=function(e,t){return"string"!=typeof e?t:0===e.indexOf("/")||-1!==e.indexOf("http")?e:(t&&"string"==typeof t&&(e=t+"/"+e),e.replace(/[^:](\/){2,}/g,"/"))},t.addParamsToUrl=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["",""],o=l.keys(n||{});if(!o.length)return t;var a=o.map(function(t){var o=r[0]+t+r[1],a=n[t];if(null!==a&&void 0!==a)return c.isArray(a)&&(a=a.join(",")),l.isPlainObject(a)?e(null,a,[o+"[","]"]):o+"="+a});return t&&"string"==typeof t?-1===t.indexOf("?")?t+"?"+a.join("&"):t+"&"+a.join("&"):a.join("&")},t.isTabHidden=function(){var e=null;return"number"==typeof window.screenX&&l.each(["","webkit","moz","ms","o"],function(t){e||(e=t+(t?"H":"h")+"idden",void 0===document[e]&&(e=null))}),function(){return!!e&&document[e]}}(),t.desktopNotify=function e(t,n){if(!window.Notification)return Promise.reject(new Error("Not support notification"));var r=Notification.permission;if("denied"===r)return Promise.reject(new Error("Notification denied"));if("granted"===r){var o=new Notification(t,n);return Promise.resolve(o)}return new Promise(function(r){Notification.requestPermission(function(){r(e(t,n))})})},t.responsibilityPatton=function(e){var t=[],n=0,r=function(){n++,a()},o=function(e){return t.push(e),this},a=function(){t.length<=n||t[n].call(this,e,r)};return{after:o,trigger:a}}},,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=n(3),i=r(a),u=n(4),s=(r(u),n(29)),l=0,c=function(){return"_"+l++},f=function(e){return e instanceof s.Map},d=function(e){return e instanceof s.List},p=function(e){return!!f(e)&&"Group"===e.get("component")},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1],n=arguments[2];return(0,s.Map)({id:c(),component:"Group",sender:e,list:s.List.of(),datetime:t,className:n})},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.Map)({id:e.id,type:e.type,component:e.component,status:e.status,file:e.file,text:e.text,src:e.src,fileName:e.fileName,fileSize:e.fileSize,documents:e.documents,questions:e.questions,videoMeeting:e.videoMeeting,datetime:e.datetime,hotCategories:e.hotCategories,resent:!1,recalled:e.recalled})},g=function(e){return(0,s.Map)({id:c(),component:"Datetime",datetime:e})},h=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=null,o=e.findKey(function(e){return!!f(e)&&e.get("id")===t});return"number"==typeof o?[o+n,r]:(o=e.findKey(function(e){return!!p(e)&&(r=e.get("list").findKey(function(e){return!!f(e)&&e.get("id")===t}),"number"==typeof r&&(r+=n),"number"==typeof r)}),[o,r])},v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.id,r=t.offset,o=t.index,a=void 0===o?null:o,i=t.indexInGroup,u=void 0===i?null:i;if(n){var s=h(e,n,r);a="number"==typeof s[0]?s[0]:null,u="number"==typeof s[1]?s[1]:null}return[a,u]},b=function(e,t,n){return!!p(e)&&(e.get("sender")===t&&("number"==typeof n&&i.default.toMinutes(e.get("datetime"))===i.default.toMinutes(n)))},_=function(e,t){return"number"==typeof t&&(!!f(e)&&("number"==typeof e.get("datetime")&&i.default.toMinutes(e.get("datetime"))!==i.default.toMinutes(t)))},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.text,n=e.file,r=e.src,o=e.documents,a=e.questions,u=e.videoMeeting,s=null;return t&&(s="Text"),i.default.isFile(n)&&(s="File"),i.default.isImage(n)&&(s="Image"),r&&"string"==typeof r&&(s="File"),i.default.isImageUrl(r)&&(s="Image"),$.isArray(o)&&(s="Documents"),$.isArray(a)&&(s="Questions"),u&&(s="VideoMeeting"),"chat.custom.categories"===e.type&&(s="HotCategories"),"chat.answer"===e.type&&(s="Answer"),s||(console.error("Not find the component name of message:",e),s="Text"),s},E=function(e){var t=e.size;if(!t)return null;var n=e.get(t-1);if(!p(n))return n;var r=n.get("list");return 1===r.size?n:r.findLast(function(e){return f(e)})},O=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"system";if(!n)return!1;var r=v(e,{id:t}),a=o(r,1),i=a[0];if("number"!=typeof i)return!1;var u=e.get(i);if(!f(u))return!1;var s=u.get("sender");return s?s===n.id:"system"===n};t.default={getNewId:c,isMap:f,isList:d,isGroup:p,createMessageGroup:y,createMessage:m,createDatetime:g,getIndexList:v,isGroupValidForSender:b,shouldAddDatetime:_,getMessageComponentName:w,getLast:E,isSendBy:O}},,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.leaveMessage=t.transferAgent=void 0;var r=n(39),o=n(3),a=function(e){return e&&e.__esModule?e:{default:e}}(o);t.transferAgent=function(){var e=a.default.system.getUrlOfSwitchToAgent();r.history.push(e)},t.leaveMessage=function(e){!0===e?r.history.replace("/message"):r.history.push("/message")}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Types=void 0;var r=n(3),o=n(37),a=function(e){return e&&e.__esModule?e:{default:e}}(o);t.Types={ENABLE_BELL:"ENABLE_BELL",DISABLE_BELL:"DISABLE_BELL",CHANGE_LANG:"CHANGE_LANG",TOAST_NOTICE:"TOAST_NOTICE",CAN_START:"SET_CAN_START",INC_NEW_MSG_COUNT:"SET_NEW_MSG_COUNT",CLEAR_NEW_MSG_COUNT:"CLEAR_NEW_MSG_COUNT",OPEN_BOX:"OPEN_BOX",CLOSE_BOX:"CLOSE_BOX",EMOJIS:"EMOJIS",TIMEOUT_MSG:"TIMEOUT_MSG",USERS:"USERS",VISITING_CARD:"VISITING_CARD",SET_SESSION:"SET_SESSION"};t.default=function(e,t){var n=t.type,o=t.payload,u={};if(void 0===e){var s=a.default.app,l=r.storage.get("app");e=_.assign({},s,l)}switch(n){case"ENABLE_BELL":return u=_.assign({},e,{bellEnabled:!0}),i(u),u;case"DISABLE_BELL":return u=_.assign({},e,{bellEnabled:!1}),i(u),u;case"CHANGE_LANG":return _.assign({},e,{lang:o});case"TOAST_NOTICE":return _.assign({},e,{toast:o});case"SET_CAN_START":return _.assign({},e,{canStart:!0});case"SET_NEW_MSG_COUNT":return _.assign({},e,{newMsgCount:e.newMsgCount+1});case"CLEAR_NEW_MSG_COUNT":return _.assign({},e,{newMsgCount:0});case"OPEN_BOX":return _.assign({},e,{boxOpened:!0});case"CLOSE_BOX":return _.assign({},e,{boxOpened:!1});case"EMOJIS":return u=_.assign({},e,{emojis:o}),i(u),u;case"TIMEOUT_MSG":return _.assign({},e,{timeoutMsg:o});case"USERS":return _.assign({},e,{users:o});case"VISITING_CARD":return _.assign({},e,{visitingCard:o});case"SET_SESSION":return _.assign({},e,{session:o});default:return e}};var i=function(e){r.storage.set("app",{bellEnabled:e.bellEnabled,emojis:e.emojis})}},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Types=void 0;var r=n(37),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.Types={SET_COMPANY:"SET_COMPANY"};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.default.company,t=arguments[1],n=t.type,r=t.payload;switch(n){case"SET_COMPANY":return r;default:return e}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),a=r(o),i=n(4),u=r(i),s=n(161),l=n(18),c=r(l),f=function(e){return e&&(e.id=+e.id,e.max_serve=+e.max_serve,e.created=+e.created,a.default.system.stashUser(e)),c.default.getVisitingCard(e&&e.id).then(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.visitingCard,r=void 0===n?{}:n;a.default.system.setVisitingCard(r),e||a.default.system.setCompany({display_name:r.name,photo:r.photo,intro:r.short_desc})}),{type:s.Types.SET_AGENT,payload:e}},d=function(){return function(e,t){t().agent&&(e({type:s.Types.AGENT_TYPING,payload:!0}),p(function(){t().agent&&e({type:s.Types.AGENT_TYPING,payload:!1})}))}},p=_.debounce(function(e){"function"==typeof e&&e.call(null)},(0,u.default)("typingValidTime",5e3));t.default={setAgent:f,typing:d}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Types=void 0;var r=n(37),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.Types={SET_AGENT:"SET_AGENT",AGENT_TYPING:"AGENT_TYPING"};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.default.agent,t=arguments[1],n=t.type,r=t.payload;switch(n){case"SET_AGENT":return r;case"AGENT_TYPING":return _.assign({},e,{typing:r});default:return e}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),a=r(o),i=n(343),u=r(i),s=(0,a.default)("http.methods",[]),l={request:u.default};_.forEach(s,function(e){"string"==typeof e&&e.length&&(e=_.toLower(e),l[e]=_.bind(u.default,null,_,e))}),t.default=l},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Types=void 0;var r=n(37),o=function(e){return e&&e.__esModule?e:{default:e}}(r),a=t.Types={LOG_IN:"LOG_IN",LOG_OUT:"LOG_OUT"};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.default.user,t=arguments[1],n=t.payload;switch(t.type){case a.LOG_IN:return _.assign({},e,n);case a.LOG_OUT:return{};default:return e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=(function(e){e&&e.__esModule}(r),n(166)),a=function(e){return function(t,n){var r=n(),a=r.chat;_.isEqual(a,e)||t({type:o.Types.SET_CHAT,payload:e})}};t.default={setChat:a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Types=void 0;var r=n(37),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.Types={SET_CHAT:"SET_CHAT"};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.default.chat,t=arguments[1],n=t.type,r=t.payload;switch(n){case"SET_CHAT":return r;default:return e}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Types=void 0;var o=function(){function e(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=n(3),i=r(a),u=n(29),s=n(37),l=r(s),c=n(92),f=r(c),d=(t.Types={ADD_NOTICE:"ADD_NOTICE",ADD_MESSAGE:"ADD_MESSAGE",UPDATE_MESSAGE:"UPDATE_MESSAGE",REMOVE_FROM_MESSAGES:"REMOVE_FROM_MESSAGES",RESET_MESSAGES:"RESET_MESSAGES",CLEAR_MESSAGES:"CLEAR_MESSAGES",ADD_EVALUATE_CARD:"ADD_EVALUATE_CARD",ADD_POST_CARD:"ADD_POST_CARD",ADD_DOCUMENTS_CARD:"ADD_DOCUMENTS_CARD"},null);t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.default.messages,t=arguments[1];d=e;var n=t.type,r=t.payload,a=t.position,i=void 0===a?{}:a,u=f.default.getIndexList(d,i),s=o(u,2),c=s[0],p=s[1];switch(n){case"ADD_MESSAGE":return m(r,c,p);case"UPDATE_MESSAGE":return g(r,c,p);case"ADD_NOTICE":return h(r,c,p);case"ADD_EVALUATE_CARD":return v(r,c);case"ADD_POST_CARD":return b(r,c);case"ADD_DOCUMENTS_CARD":return _(r,c);case"REMOVE_FROM_MESSAGES":return w(c,p);case"RESET_MESSAGES":return E(r);case"CLEAR_MESSAGES":return O();default:return e}};var p=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!f.default.isMap(t))return d;if(!r){var o=t.get("datetime"),a=null;if("number"==typeof n){var u=d.get(n);u&&"Datetime"===u.get("component")&&i.default.toMinutes(u.get("datetime"))===i.default.toMinutes(o)&&n++,a=d.get(n>=1?n-1:0)}else a=d.get(d.size-1);d.size&&!f.default.shouldAddDatetime(a,o)||(d=e(f.default.createDatetime(o),n,!0),"number"==typeof n&&(n+=1))}return d="number"==typeof n?d.insert(n,t):d.push(t)},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=e.sender,r=void 0===n?null:n,o=e.datetime,a=e.className,i=d.get(t);return"number"!=typeof t&&(i=d.get(d.size-1)),f.default.isGroupValidForSender(i,r,o)||(i=f.default.createMessageGroup(r,o,a),d=p(i,t,o<=0)),i},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=arguments[2],r=y(e,t);t=f.default.getIndexList(d,{id:r.get("id")})[0];var o=f.default.createMessage(e);return d.updateIn([t,"list"],function(e){return"number"==typeof n?e.insert(n,o):e.push(o)})},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=arguments[2],r=e.status,o=e.src,a=e.resent,i=e.error,u=e.recalled;return d.updateIn([t,"list",n],function(e){if(e)return r&&(e=e.set("status",r)),o&&(e=e.set("src",o)),a&&(e=e.set("resent",a)),u&&(e=e.set("recalled",u)),e=e.set("error",i)})},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=arguments[2],r=(0,u.Map)({id:e.id||f.default.getNewId(),component:"Notice",type:e.type,data:e.data,datetime:e.datetime});e.sender=null,e.className="system-group";var o=y(e,t);return t=f.default.getIndexList(d,{id:o.get("id")})[0],d.updateIn([t,"list"],function(e){return"number"==typeof n?e.insert(n,r):e.push(r)})},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return p((0,u.Map)({id:f.default.getNewId(),component:"EvaluateCard",chatId:e.chatId,datetime:e.datetime}),t,e.datetime<=0)},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return p((0,u.Map)({id:f.default.getNewId(),component:"PostCard",datetime:e.datetime,title:e.title,url:e.url,cover:e.cover,content:e.content}),t,e.datetime<=0)},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return p((0,u.Map)({id:f.default.getNewId(),component:"DocumentsCard",datetime:e.datetime,title:e.title,documents:e.documents}),t,e.datetime<=0)},w=function(e,t){return"number"==typeof t?d.updateIn([e,"list"],function(e){return e.delete(t)}):d.delete(e)},E=function(e){return e instanceof u.List?e:O()},O=function(){return u.List.of()}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Types=void 0;var i,u,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),c=function(e){return e&&e.__esModule?e:{default:e}}(l),f=n(2),d=n(16),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(d),y=t.Types={RESEND:"RESEND",YOUR_AGENT:"YOUR_AGENT",ENQUEUE_FAILED:"ENQUEUE_FAILED",ENQUEUE_TIMEOUT:"ENQUEUE_TIMEOUT",ENQUEUE_SUCCESS:"ENQUEUE_SUCCESS",QUEUE_PROGRESS:"QUEUE_PROGRESS",LOAD_MORE:"LOAD_MORE",OFFLINE:"OFFLINE",CHATTING:"CHATTING",AGENT_ASSIGN_FAILED:"AGENT_ASSIGN_FAILED",BANNED:"BANNED"},m=(u=i=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"content",value:function(){var e=this.props,t=e.id,n=e.type,r=e.data;switch(n){case"RESEND":return r.a_resend='<a href="javascript:;" data-action="resend" data-id="'+t+'">',(0,f.trans)("notifies.sendFailure",r);case"YOUR_AGENT":return(0,f.trans)("notifies.yourAgent",r);case"ENQUEUE_FAILED":return r.reason=r.reason?"("+r.reason+")":"",(0,f.trans)("notifies.enqueueFailed",r);case"ENQUEUE_TIMEOUT":return r.msg;case"ENQUEUE_SUCCESS":return(0,f.trans)("notifies.enqueueSuccess",r);case"QUEUE_PROGRESS":return(0,f.trans)("notifies.queueProgress",r);case"LOAD_MORE":return'<a href="javascript:;" data-action="loadMore" data-id="'+t+'">'+(0,f.trans)("notifies.loadMore")+"</a>";case"OFFLINE":return(0,f.trans)("notifies.offline",r);case"CHATTING":return(0,f.trans)("notifies.chatting",r);case"AGENT_ASSIGN_FAILED":return(0,f.trans)("notifies.assignFailed");case"BANNED":return(0,f.trans)("notifies.banned");default:return null}}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.data,r=void 0===n?{}:n;return c.default.createElement("div",{id:t,className:"chat-data",style:{clear:"both"}},r.content?c.default.createElement("span",null,r.content):c.default.createElement("span",{dangerouslySetInnerHTML:{__html:this.content()}}))}}]),t}(c.default.Component),i.types=y,i.propTypes={id:p.id.isRequired,type:c.default.PropTypes.oneOf([].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(_.values(y)))),data:c.default.PropTypes.object},u);t.default=m},,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r),a=function(e){var t="?";return"string"==typeof e.children&&(t=e.children[0]||t),o.default.createElement("div",e,_.toUpper(t))};t.default=a},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentsCard=t.LeaveMessageCard=t.EvaluateCard=t.PostCard=void 0;var o=n(411),a=r(o),i=n(412),u=r(i),s=n(414),l=r(s),c=n(428),f=r(c);t.PostCard=a.default,t.EvaluateCard=u.default,t.LeaveMessageCard=l.default,t.DocumentsCard=f.default},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=n(0),i=r(a),u=n(67),s=r(u),l=function(e){return i.default.createElement(s.default,e,i.default.createElement("div",{className:"form_item_box"},e.children),i.default.createElement("span",{className:"important"},e.errors))};l.propTypes=o({},s.default.propsTypes,{errors:i.default.PropTypes.string}),t.default=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.NoAgent=t.Status=void 0;var o=n(432),a=r(o),i=n(433),u=r(i);t.Status=a.default,t.NoAgent=u.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(187),u=r(i),s=n(3),l=r(s),c=n(4),f=r(c),d=n(2),p=r(d),y=n(459),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(y),g=null,h=function(){return g||(g=(0,u.default)((0,f.default)("hosts.visitorSocketConnector"),{transports:window.WebSocket?["websocket"]:["polling","websocket"],query:{cookie:l.default.system.uuid(),companyId:(0,f.default)("global.company_id"),lang:p.default.current(),platform:(0,f.default)("global.isMobile")?"mobile":"web",kf5_user_id:(0,f.default)("global.kf5_user_id")||""}}),g.once("connect",function(){g.on("connect",function(){l.default.system.toast((0,d.trans)("wsConnect.success"))})}),g.on("connect_timeout",function(){l.default.system.toast((0,d.trans)("wsConnect.timeout"))}),g.on("connect_error",function(e){l.default.system.toast((0,d.trans)("wsConnect.failed"))}),g.on("reconnect_error",function(e){l.default.system.toast((0,d.trans)("wsConnect.reFailed"))}),g.on("error",function(e){console.error(e)}),g.on("message",function(e){var t=e.ackId,n=void 0===t?null:t,r=(e.code,e.data),i=void 0===r?null:r,u=e.errors,s=void 0===u?null:u;if("number"==typeof n&&g.emit("ack",n),i){var c=i.meta,f=void 0===c?{}:c,d=o(i,["meta"]),p=f.event||{},y=p.name,h=void 0===y?null:y,v=o(p,["name"]),b=l.default.toCamelCase(h,".");if(b)return void("function"==typeof m[b]&&m[b].call(null,a({},v,d),s));var _=d.message,w=void 0===_?null:_;if(w)return m.message(w);var E=d.agent,O=void 0===E?null:E,T=d.visitor,M=void 0===T?null:T,P=d.chat,S=void 0===P?null:P,j=d.session,C=void 0===j?null:j;l.default.system.setVisitor(M),l.default.system.cacheIdentity(M),l.default.system.setSession(C),l.default.system.setAgent(O),l.default.system.setChat(S),S&&l.default.inIFrame()&&l.default.system.canStart()}}),g)},v=function(){g&&(g.disconnect(),g=null)};t.default={start:h,destroy:v},$(window).on("beforeunload",v)},,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={footerPrompt:"technical support is provided by kf5.com",back:"Back",packUp:"Fold",remove:"remove",soundOpenTitle:"Turn on sound",soundCloseTitle:"Turn off sound",newWindowOpenTitle:"Open in new browse",onlineConsultTitle:"Chat online",leaveMsgConsultTitle:"Leave a message",selectConsultType:"Please select your question type",noAgentsOnline:"No agents current online",leaveMessageToUs:"Leave a message to us",notifies:{loadMore:"Load more",yourAgent:"{{agent}} is ready to serve you",enqueueSuccess:"Queueing to be served, {{number}} in front you, or {{a_leave_msg}}leave a message{{_a}}",enqueueFailed:"Queue failed {{reason}}, {{a_retry}}retry{{_a}} or {{a_leave_msg}}leave a message{{_a}}",queueProgress:"{{number}} queueing in front you",sendFailure:"Message sent failed, {{a_resend}}retry{{_a}}",offline:"No agent current online, {{a_retry}}retry{{_a}} or {{a_leave_msg}}leave a message{{_a}}",chatting:"You are in the chat, please send message directly",assignFailed:"Agent assign failed",banned:"You have been banned",withdrawn:"A message has been withdrawn"},uploadFile:"upload attachment",uploadFileFailed:"upload attachment failed",uploadError:{extError:"File extension only support: zip, rar, word, xls, xlsx, txt, jpg, png ...",sizeError:"File size too large",sizeLimitError:"File size limit 10M",emptyError:"File empty",unknownError:"Unknown error"},sendFailure:"Failed",resend:"Resend",typing:"Typing...",submit:"Submit",submitSuccess:"Submit successfully",submitFailed:"Submit failed",leaveMsgForm:{title:"Please leave a message to us",notice:"Our agents will handle your request soon",nameTitle:"Your name",email:{title:"Your email",invalidFormat:"Please type correct email address"},mobile:{title:"Your phone",invalidFormat:"Please type correct phone number"},content:{title:"Message content",exceedMaxLength:"Content maximum length {{max_length}}"},select:"Please select"},leaveMsgSuccess:"Message submit successfully",leaveMsgFailed:"Message submit failed",leaveMsgClosed:"Message function closed",evaluate:{title:"Please rate our service",isProblemSolved:"Is the problem solved ?",solved:"Solved",unsolved:"Not Solved",satisfyLevel:{satisfaction:"satisfaction",generalSatisfaction:"general satisfaction",basicSatisfaction:"basic satisfaction",disSatisfaction:"disSatisfaction",notQuiteSatisfaction:"not quite satisfaction"},yourChoice:"Your rating is: ",reason:"Reason"},newMsg:"New message",chatInput:{placeholder:"Please type here",emoji:"frequently used",transferToAgent:"Chat to an agent",leaveMsg:"Leave a message",file:"Image/File",send:"Send",banSend:"No message"},inviteChat:{greeting:"Hi, how can I help you?",submit:"Accept",reject:"Reject"},wsConnect:{success:"Connection successful",timeout:"Connection timeout, please check your network status",failed:"Connection failed, please check your network status",reFailed:"Reconnection failed, please check your network status"},robotSearchResult:{title:"{{robot_name}} has found following answers for you"},searchResult:{common:"Common problems",title:"Found following articles for you",empty:"No related content"},haveNewMsg:"You have a new message",inviteVideoMeeting:"Invite you to join a {{a_video}}video chat{{_a}}",notSolveProblem:"Not solve the problem?",or:"or",transferToAgent:"Chat to an agent",leaveMessage:"leave a message",errors:{formattingError:"sorry, this format is not supported. only zip,rar,doc,docx,word,xls,xlsx,jpg and png format can be upload",maxSizeError:"exceed the size !,the size of single file could not largeer than 2MB",serviceTimeError:"not in service time"},charLeft:"{{count}} charactor left",hotCategories:"Hot Categories"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={footerPrompt:"逸创云客服提供技术支持",back:"返回",packUp:"收起",remove:"删除",soundOpenTitle:"取消静音",soundCloseTitle:"静音",newWindowOpenTitle:"新窗口打开",onlineConsultTitle:"在线咨询",leaveMsgConsultTitle:"留言咨询",selectConsultType:"请选择咨询类型",noAgentsOnline:"对不起，暂时没有客服在线",leaveMessageToUs:"请给我们留言",notifies:{loadMore:"加载更多",yourAgent:"{{agent}} 为您服务",enqueueSuccess:"已进入排队，前方{{number}}人，或给我们{{a_leave_msg}}留言{{_a}}",enqueueFailed:"排队失败{{reason}}，{{a_retry}}点击重试{{_a}}或{{a_leave_msg}}去留言{{_a}}",queueProgress:"前方排队{{number}}人，请稍等",sendFailure:"发送失败，{{a_resend}}点击重发{{_a}}",offline:"当前没有客服在线，{{a_retry}}点击重试{{_a}}或{{a_leave_msg}}去留言{{_a}}",chatting:"您已经在对话中，请直接发送消息",assignFailed:"客服分配失败",banned:"您已被封禁",withdrawn:"客服撤回了一条消息"},uploadFile:"上传附件",uploadFileFailed:"上传附件失败",uploadError:{extError:"当前仅支持 zip, rar, word, xls, xlsx, txt, jpg, png 等格式",sizeError:"文件大小超过限制",sizeLimitError:"文件大小不能超过 10M",emptyError:"文件不能为空",unknownError:"未知错误"},sendFailure:"失败",resend:"重发",typing:"对方正在输入...",submit:"提交",submitSuccess:"提交成功",submitFailed:"提交失败，请重试",leaveMsgForm:{title:"请将您的问题留言给我们",notice:"我们将在1-3个工作日内回复您",nameTitle:"您的称呼",email:{title:"您的邮箱地址",invalidFormat:"请输入正确的邮箱地址"},mobile:{title:"您的手机号码",invalidFormat:"请输入合法的手机号码"},content:{title:"留言信息",exceedMaxLength:"最大长度不超过{{max_length}}个字符"},select:"请选择"},leaveMsgSuccess:"留言成功",leaveMsgFailed:"留言失败，请重试",leaveMsgClosed:"抱歉，留言功能已关闭",evaluate:{title:"请对本次服务进行评价",isProblemSolved:"问题是否已解决？",solved:"已解决",unsolved:"未解决",satisfyLevel:{satisfaction:"满意",generalSatisfaction:"一般",basicSatisfaction:"基本满意",disSatisfaction:"不满意",notQuiteSatisfaction:"不太满意"},yourChoice:"您对本次服务的评价为：",reason:"评价内容"},newMsg:"新消息",chatInput:{placeholder:"请输入您的问题~",emoji:"常用表情",transferToAgent:"转人工客服",leaveMsg:"去留言",file:"图片/附件",send:"发送",banSend:"无内容"},inviteChat:{greeting:"您好，有什么可以帮助您吗？",submit:"接受",reject:"拒绝"},wsConnect:{success:"连接成功",timeout:"连接超时，请检查您的网络状况",failed:"连接失败，请检查您的网络状况",reFailed:"重连失败，请检查您的网络状况"},robotSearchResult:{title:"{{robot_name}}为您找到以下内容"},searchResult:{common:"常见问题",title:"为您找到以下内容",empty:"抱歉，没有找到相关内容"},haveNewMsg:"您有新消息",inviteVideoMeeting:"邀请您进行{{a_video}}视频会话{{_a}}",notSolveProblem:"问题没有解决？",or:"或",transferToAgent:"转客服",leaveMessage:"去留言",errors:{formattingError:"不支持的附件格式,仅支持zip,rar,doc,docx,word,xls,xlsx,jpg,png等格式",maxSizeError:"单个附件超过尺寸,不能超过2MB",serviceTimeError:"不在服务时间"},charLeft:"剩余 {{count}} 字符",hotCategories:"热门分类"}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}n(202);var o=n(0),a=r(o),i=n(120),u=n(13),s=n(36),l=r(s),c=n(39),f=r(c);(0,r(n(437)).default)(),(0,i.render)(a.default.createElement(u.Provider,{store:l.default},f.default),document.getElementById("app-main"))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(106),a=r(o);n(203);var i=n(109),u=r(i),s=n(4),l=r(s),c=n(2),f=r(c);a.default.templateSettings.interpolate=/{{([\s\S]+?)}}/g,window._=a.default,u.default.config({warnings:!1}),window.Promise=u.default,window.kchat={version:"2.1.0",config:l.default,locales:f.default}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(27),a=r(o),i=n(107),u=(r(i),n(204)),s=(r(u),n(206)),l=(r(s),n(207));r(l);window.$=window.jQuery=a.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(205),a=r(o),i=n(27),u=r(i);window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,100)},window.anime=a.default,window.list_left_fade_in=(0,a.default)({translateX:[-10,0],opacity:[0,1],delay:function(e,t){return 50*t}}),window.toast_in=(0,a.default)({targets:(0,u.default)(".toast").get(0),scale:[1.15,1],translateY:["-50%","-50%"],translateX:["-50%","-50%"],opacity:[0,1],autoplay:!1,complete:function(){(0,a.default)({targets:this.targets,duration:600,delay:1e3,scale:[1,.8],translateY:["-50%","-50%"],translateX:["-50%","-50%"],easing:"easeInOutExpo",opacity:[1,0],complete:function(){this.targets.style.display="none"}})}}),window.pop_bottom_in=(0,a.default)({scale:[.8,1],translateY:["20%","0%"],opacity:1,duration:600,autoplay:!1}),window.pop_bottom_out=(0,a.default)({scale:[1,.8],translateY:["0","20%"],opacity:0,duration:600,autoplay:!1}),window.bottom_fadein=(0,a.default)({translateY:[10,0],opacity:[0,1],duration:600,easing:"easeOutSine",autoplay:!1})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o={duration:1e3,delay:0,loop:!1,autoplay:!0,direction:"normal",easing:"easeOutElastic",elasticity:400,round:!1,begin:void 0,update:void 0,complete:void 0},a="translateX translateY translateZ rotate rotateX rotateY rotateZ scale scaleX scaleY scaleZ skewX skewY".split(" "),i={arr:function(e){return Array.isArray(e)},obj:function(e){return-1<Object.prototype.toString.call(e).indexOf("Object")},svg:function(e){return e instanceof SVGElement},dom:function(e){return e.nodeType||i.svg(e)},num:function(e){return!isNaN(parseInt(e))},str:function(e){return"string"==typeof e},fnc:function(e){return"function"==typeof e},und:function(e){return void 0===e},nul:function(e){return"null"==typeof e},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return i.hex(e)||i.rgb(e)||i.hsl(e)}},u=function(){var e={},t={Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e,t){if(0===e||1===e)return e;var n=1-Math.min(t,998)/1e3,r=e/1-1;return-Math.pow(2,10*r)*Math.sin(2*(r-n/(2*Math.PI)*Math.asin(1))*Math.PI/n)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,n=4;e<((t=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*t-2)/22-e,2)}};return["Quad","Cubic","Quart","Quint","Expo"].forEach(function(e,n){t[e]=function(e){return Math.pow(e,n+2)}}),Object.keys(t).forEach(function(n){var r=t[n];e["easeIn"+n]=r,e["easeOut"+n]=function(e,t){return 1-r(1-e,t)},e["easeInOut"+n]=function(e,t){return.5>e?r(2*e,t)/2:1-r(-2*e+2,t)/2},e["easeOutIn"+n]=function(e,t){return.5>e?(1-r(1-2*e,t))/2:(r(2*e-1,t)+1)/2}}),e.linear=function(e){return e},e}(),s=function(e){return i.str(e)?e:e+""},l=function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},c=function(e){if(i.col(e))return!1;try{return document.querySelectorAll(e)}catch(e){return!1}},f=function e(t){return t.reduce(function(t,n){return t.concat(i.arr(n)?e(n):n)},[])},d=function(e){return i.arr(e)?e:(i.str(e)&&(e=c(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])},p=function(e,t){return e.some(function(e){return e===t})},y=function(e,t){var n={};return e.forEach(function(e){var r=JSON.stringify(t.map(function(t){return e[t]}));n[r]=n[r]||[],n[r].push(e)}),Object.keys(n).map(function(e){return n[e]})},m=function(e){return e.filter(function(e,t,n){return n.indexOf(e)===t})},g=function(e){var t,n={};for(t in e)n[t]=e[t];return n},h=function(e,t){for(var n in t)e[n]=i.und(e[n])?t[n]:e[n];return e},v=function(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,n,r){return t+t+n+n+r+r});var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);e=parseInt(t[1],16);var n=parseInt(t[2],16),t=parseInt(t[3],16);return"rgb("+e+","+n+","+t+")"},b=function(e){e=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e);var t=parseInt(e[1])/360,n=parseInt(e[2])/100,r=parseInt(e[3])/100;if(e=function(e,t,n){return 0>n&&(n+=1),1<n&&--n,n<1/6?e+6*(t-e)*n:.5>n?t:n<2/3?e+(t-e)*(2/3-n)*6:e},0==n)n=r=t=r;else var o=.5>r?r*(1+n):r+n-r*n,a=2*r-o,n=e(a,o,t+1/3),r=e(a,o,t),t=e(a,o,t-1/3);return"rgb("+255*n+","+255*r+","+255*t+")"},_=function(e){return/([\+\-]?[0-9|auto\.]+)(%|px|pt|em|rem|in|cm|mm|ex|pc|vw|vh|deg)?/.exec(e)[2]},w=function(e,t,n){return _(t)?t:-1<e.indexOf("translate")?_(n)?t+_(n):t+"px":-1<e.indexOf("rotate")||-1<e.indexOf("skew")?t+"deg":t},E=function(e,t){if(t in e.style)return getComputedStyle(e).getPropertyValue(l(t))||"0"},O=function(e,t){var n=-1<t.indexOf("scale")?1:0,r=e.style.transform;if(!r)return n;for(var o=/(\w+)\((.+?)\)/g,a=[],i=[],u=[];a=o.exec(r);)i.push(a[1]),u.push(a[2]);return r=u.filter(function(e,n){return i[n]===t}),r.length?r[0]:n},T=function(e,t){return i.dom(e)&&p(a,t)?"transform":i.dom(e)&&(e.getAttribute(t)||i.svg(e)&&e[t])?"attribute":i.dom(e)&&"transform"!==t&&E(e,t)?"css":i.nul(e[t])||i.und(e[t])?void 0:"object"},M=function(e,t){switch(T(e,t)){case"transform":return O(e,t);case"css":return E(e,t);case"attribute":return e.getAttribute(t)}return e[t]||0},P=function(e,t,n){return i.col(t)?t=i.rgb(t)?t:i.hex(t)?v(t):i.hsl(t)?b(t):void 0:_(t)?t:(e=_(_(e.to)?e.to:e.from),!e&&n&&(e=_(n)),e?t+e:t)},S=function(e){var t=/-?\d*\.?\d+/g;return{original:e,numbers:s(e).match(t)?s(e).match(t).map(Number):[0],strings:s(e).split(t)}},j=function(e,t,n){return t.reduce(function(t,r,o){return r=r||n[o-1],t+e[o-1]+r})},C=function(e){return e=e?f(i.arr(e)?e.map(d):d(e)):[],e.map(function(e,t){return{target:e,id:t}})},k=function(e,t,n,r){return"transform"===n?(n=e+"("+w(e,t.from,t.to)+")",t=e+"("+w(e,t.to)+")"):(e="css"===n?E(r,e):void 0,n=P(t,t.from,e),t=P(t,t.to,e)),{from:S(n),to:S(t)}},x=function(e,t){var n=[];return e.forEach(function(r,o){var a=r.target;return t.forEach(function(t){var u=T(a,t.name);if(u){var s;s=t.name;var l=t.value,l=d(i.fnc(l)?l(a,o):l);s={from:1<l.length?l[0]:M(a,s),to:1<l.length?l[1]:l[0]},l=g(t),l.animatables=r,l.type=u,l.from=k(t.name,s,l.type,a).from,l.to=k(t.name,s,l.type,a).to,l.round=i.col(s.from)||l.round?1:0,l.delay=(i.fnc(l.delay)?l.delay(a,o,e.length):l.delay)/V.speed,l.duration=(i.fnc(l.duration)?l.duration(a,o,e.length):l.duration)/V.speed,n.push(l)}})}),n},N=function(e,t){var n=x(e,t);return y(n,["name","from","to","delay","duration"]).map(function(e){var t=g(e[0]);return t.animatables=e.map(function(e){return e.animatables}),t.totalDuration=t.delay+t.duration,t})},A=function(e,t){e.tweens.forEach(function(n){var r=n.from,o=e.duration-(n.delay+n.duration);n.from=n.to,n.to=r,t&&(n.delay=o)}),e.reversed=!e.reversed},I=function(e){if(e.length)return Math.max.apply(Math,e.map(function(e){return e.totalDuration}))},D=function(e){var t=[],n=[];return e.tweens.forEach(function(e){"css"!==e.type&&"transform"!==e.type||(t.push("css"===e.type?l(e.name):"transform"),e.animatables.forEach(function(e){n.push(e.target)}))}),{properties:m(t).join(", "),elements:m(n)}},F=function(e){var t=D(e);t.elements.forEach(function(e){e.style.willChange=t.properties})},L=function(e){D(e).elements.forEach(function(e){e.style.removeProperty("will-change")})},R=function(e,t){var n=e.path,r=e.value*t,o=function(o){return o=o||0,n.getPointAtLength(1<t?e.value+o:r+o)},a=o(),i=o(-1),o=o(1);switch(e.name){case"translateX":return a.x;case"translateY":return a.y;case"rotate":return 180*Math.atan2(o.y-i.y,o.x-i.x)/Math.PI}},U=function(e,t){var n=Math.min(Math.max(t-e.delay,0),e.duration)/e.duration,r=e.to.numbers.map(function(t,r){var o=e.from.numbers[r],a=u[e.easing](n,e.elasticity),o=e.path?R(e,a):o+a*(t-o);return o=e.round?Math.round(o*e.round)/e.round:o});return j(r,e.to.strings,e.from.strings)},B=function(e,t){var n;e.currentTime=t,e.progress=t/e.duration*100;for(var o=0;o<e.tweens.length;o++){var a=e.tweens[o];a.currentValue=U(a,t);for(var i=a.currentValue,u=0;u<a.animatables.length;u++){var s=a.animatables[u],l=s.id,s=s.target,c=a.name;switch(a.type){case"css":s.style[c]=i;break;case"attribute":s.setAttribute(c,i);break;case"object":s[c]=i;break;case"transform":n||(n={}),n[l]||(n[l]=[]),n[l].push(i)}}}if(n)for(o in r||(r=(E(document.body,"transform")?"":"-webkit-")+"transform"),n)e.animatables[o].target.style[r]=n[o].join(" ");e.settings.update&&e.settings.update(e)},q=function(e){var t={};t.animatables=C(e.targets),t.settings=h(e,o);var n,r=t.settings,a=[];for(n in e)if(!o.hasOwnProperty(n)&&"targets"!==n){var u=i.obj(e[n])?g(e[n]):{value:e[n]};u.name=n,a.push(h(u,r))}return t.properties=a,t.tweens=N(t.animatables,t.properties),t.duration=I(t.tweens)||e.duration,t.currentTime=0,t.progress=0,t.ended=!1,t},G=[],H=0,z=function(){var e=function(){H=requestAnimationFrame(t)},t=function(t){if(G.length){for(var n=0;n<G.length;n++)G[n].tick(t);e()}else cancelAnimationFrame(H),H=0};return e}(),V=function(e){var t=q(e),n={};return t.tick=function(e){t.ended=!1,n.start||(n.start=e),n.current=Math.min(Math.max(n.last+e-n.start,0),t.duration),B(t,n.current);var r=t.settings;r.begin&&n.current>=r.delay&&(r.begin(t),r.begin=void 0),n.current>=t.duration&&(r.loop?(n.start=e,"alternate"===r.direction&&A(t,!0),i.num(r.loop)&&r.loop--):(t.ended=!0,t.pause(),r.complete&&r.complete(t)),n.last=0)},t.seek=function(e){B(t,e/100*t.duration)},t.pause=function(){L(t);var e=G.indexOf(t);-1<e&&G.splice(e,1)},t.play=function(e){t.pause(),e&&(t=h(q(h(e,t.settings)),t)),n.start=0,n.last=t.ended?0:t.currentTime,e=t.settings,"reverse"===e.direction&&A(t),"alternate"!==e.direction||e.loop||(e.loop=1),F(t),G.push(t),H||z()},t.restart=function(){t.reversed&&A(t),t.pause(),t.seek(0),t.play()},t.settings.autoplay&&t.play(),t};V.version="1.1.1",V.speed=1,V.list=G,V.remove=function(e){e=f(i.arr(e)?e.map(d):d(e));for(var t=G.length-1;0<=t;t--)for(var n=G[t],r=n.tweens,o=r.length-1;0<=o;o--)for(var a=r[o].animatables,u=a.length-1;0<=u;u--)p(e,a[u].target)&&(a.splice(u,1),a.length||r.splice(o,1),r.length||n.pause())},V.easings=u,V.getValue=M,V.path=function(e){return e=i.str(e)?c(e)[0]:e,{path:e,value:e.getTotalLength()}},V.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},t.default=V},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(27),a=r(o);(0,r(n(108)).default)(a.default);/*!
* Buttons helper for fancyBox
* version: 1.0.5 (Mon, 15 Oct 2012)
* @requires fancyBox v2.0 or later
*
* Usage:
*     $(".fancybox").fancybox({
*         helpers : {
*             buttons: {
*                 position : 'top'
*             }
*         }
*     });
*
*/
var i=a.default.fancybox;i.helpers.buttons={defaults:{skipSingle:!1,position:"top",tpl:'<div id="fancybox-buttons"><a class="fancybox-btnPrev" title="" href="javascript:;"></a><a class="fancybox-btnPlay fancybox-btnPlayOn" title="" href="javascript:;"></a><a class="fancybox-btnNext" title="" href="javascript:;"></a><a class="fancybox-btnToggle" title="" href="javascript:;"></a><a class="fancybox-btnClose" title="" href="javascript:;"></a></div>'},list:null,buttons:null,beforeLoad:function(e,t){t.margin["bottom"===e.position?2:0]+=30},onPlayStart:function(){this.buttons&&this.buttons.play.removeClass("fancybox-btnPlayOn")},onPlayEnd:function(){this.buttons&&this.buttons.play.addClass("fancybox-btnPlayOn")},afterShow:function(e,t){var n=this.buttons;n||(this.list=(0,a.default)(e.tpl).addClass(e.position).appendTo("body"),n={prev:this.list.find(".fancybox-btnPrev").click(i.prev),next:this.list.find(".fancybox-btnNext").click(i.next),play:this.list.find(".fancybox-btnPlay").click(i.play),toggle:this.list.find(".fancybox-btnToggle").click(i.toggle),close:this.list.find(".fancybox-btnClose").click(i.close)}),t.index>0||t.loop?n.prev.removeClass("fancybox-btnDisabled"):n.prev.addClass("fancybox-btnDisabled"),t.loop||t.index<t.group.length-1?(n.next.removeClass("fancybox-btnDisabled"),n.play.removeClass("fancybox-btnDisabled")):(n.next.addClass("fancybox-btnDisabled"),n.play.addClass("fancybox-btnDisabled")),this.buttons=n,this.onUpdate(e,t)},onUpdate:function(e,t){var n;this.buttons&&(n=this.buttons.toggle.removeClass("fancybox-btnDisabled fancybox-btnToggleOn"),t.canShrink?n.addClass("fancybox-btnToggleOn"):t.canExpand||n.addClass("fancybox-btnDisabled"))},beforeClose:function(){this.list&&this.list.remove(),this.list=null,this.buttons=null}},(0,a.default)(document).on("click",".chat-msg-text img",function(e){for(var t=(0,a.default)(".chat-msg-text img").toArray(),n=[],r=0,o=0;o<t.length;++o)t[o]===e.target&&(r=o),n.push({href:t[o].src,title:t[o].src});a.default.fancybox(n,{type:"image",index:r,helpers:{buttons:{}}})})},function(e,t,n){"use strict";function r(){}var o=n(27),a=function(e){return e&&e.__esModule?e:{default:e}}(o);n(208),a.default.fn.scrollUnique=function(){return(0,a.default)(this).each(function(){var e="mousewheel";void 0!==document.mozHidden&&(e="DOMMouseScroll"),(0,a.default)(this).on(e,function(e){var t=this.scrollTop,n=this.scrollHeight,r=this.clientHeight,o=e.originalEvent.wheelDelta?e.originalEvent.wheelDelta:-(e.originalEvent.detail||0);(o>0&&t<=o||o<0&&n-r-t<=-1*o)&&(this.scrollTop=o>0?0:n,e.preventDefault())})})},(0,a.default)(document).ready(function(){(0,a.default)(document.body).on("mousewheel",".support-header_content_more_info, .chat-textarea-box_input, .chat-textarea-face-box_list, .support-body",function(e,t){e.stopPropagation(),e.preventDefault(),this.scrollTop=this.scrollTop+e.deltaY*e.deltaFactor*-1})}),window.kf5_head_scroll=r},function(e,t,n){"use strict";var r=n(27),o=function(e){return e&&e.__esModule?e:{default:e}}(r);!function(e,t,n,r){e.throttle=function(e,t,n,o){function a(){function a(){u=+new Date,n.apply(l,f)}function s(){i=r}var l=this,c=+new Date-u,f=arguments;o&&!i&&a(),i&&clearTimeout(i),o===r&&c>e?a():!0!==t&&(i=setTimeout(o?s:a,o===r?e-c:e))}var i,u=0;return"boolean"!=typeof t&&(o=n,n=t,t=r),a},e.debounce=function(t,n,o){return o===r?e.throttle(t,n,!1):e.throttle(t,o,!1!==n)}}(o.default,window,document)},,,,,,,,,function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.emojis=void 0;var o=n(46),a=function(e){return e&&e.__esModule?e:{default:e}}(o);t.emojis=function(){var e=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],t=["1F600","1F607","1F608","1F60E","1F610","1F611","1F615","1F617","1F619","1F61B","1F61F","1F626","1F627","1F62C","1F62E","1F62F"];return[].concat(r(e.map(function(e){return"1F60"+e})),r(e.map(function(e){return"1F61"+e})),r(e.map(function(e){return"1F62"+e}))).filter(function(e){return t.indexOf(e)<0}).map(a.default.convert.fromCodePoint)}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.debug=!1,t.cookie={expires:3650},t.storage={prefix:"com.kf5."},t.session={prefix:"com.kf5."},t.toast={limit:3,interval:1200,time:1400},t.typingValidTime=5e3,t.chatQueueSuccessDelayShow=1200,t.desktopNotify={icon:"/images/icons/desktop-kchat.png",time:6e4},t.bells={newMessage:"https://assets-cdn.kf5.com/sounds/incoming-message.mp3"},t.http={methods:["GET","POST","PUT","DELETE","PATCH"],checkData:function(e){var t=e.error;if(void 0===t?null:t)throw e;return e},errorHandler:function(e){throw e}},t.hosts={assets:"https://assets-cdn.kf5.com",visitorChatAPI:"https://im2-visitor.kf5.com:443",visitorSocketConnector:"wss://im2-visitor-connector.kf5.com:443"}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(60),a=n(156),i=r(a),u=n(164),s=r(u),l=n(161),c=r(l),f=n(159),d=r(f),p=n(166),y=r(p),m=n(167),g=r(m);t.default=(0,o.combineReducers)({app:i.default,user:s.default,agent:c.default,company:d.default,chat:y.default,messages:g.default})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),o=function(e){return e&&e.__esModule?e:{default:e}}(r),a=n(3),i=(0,o.default)("storage.prefix"),u=function(e){return i+e},s=function(e,t){e=u(e),t=a.base.stringify(t),localStorage&&localStorage.setItem(e,t)},l=function(e){e=u(e);var t=localStorage&&localStorage.getItem(e);return a.base.parseJSON(t)||t},c=function(e){e=u(e),localStorage&&localStorage.removeItem(e)};t.default={set:s,get:l,remove:c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),o=function(e){return e&&e.__esModule?e:{default:e}}(r),a=n(3),i=(0,o.default)("session.prefix"),u=function(e){return i+e},s=function(e,t){e=u(e),t=a.base.stringify(t),sessionStorage&&sessionStorage.setItem(e,t)},l=function(e){e=u(e);var t=sessionStorage&&sessionStorage.getItem(e);return a.base.parseJSON(t)||t},c=function(e){e=u(e),sessionStorage&&sessionStorage.removeItem(e)};t.default={set:s,get:l,remove:c}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){return e?(0,P.getIdentity)(String(e)):t?(0,P.uvid)(String(t),(0,P.getNamespace)(String((0,l.default)("global.company_id")))):(0,P.getIdentity)()}function a(e){var t={};try{t=c.base.parseJSON(e.msg)}catch(e){}return e.msg=null,t.type&&(e.type="chat.custom."+t.type),t}Object.defineProperty(t,"__esModule",{value:!0}),t.warn=t.getTempDataWithSender=t.desktopNotifyMessage=t.setSession=t.setVisitingCard=t.normalizeQuery=t.setTimeoutMsg=t.tryReplyOnTimeout=t.getUrlOfAppStart=t.getUrlOfSwitchToAgent=t.attachWaves=t.stashUser=t.displayMessage=t.setVisitor=t.setAgentTyping=t.setAgent=t.setChat=t.setCompany=t.changeLang=t.setBoxStatus=t.ringBell=t.toast=t.canStart=t.cacheIdentity=t.uuid=void 0;var i=n(89),u=(r(i),n(91)),s=(r(u),n(4)),l=r(s),c=n(3),f=n(2),d=n(36),p=r(d),y=n(61),m=r(y),g=n(341),h=r(g),v=n(160),b=r(v),_=n(346),w=r(_),E=n(165),O=r(E),T=n(38),M=r(T),P=n(347),S=null,j=(t.uuid=function(){return o((0,l.default)("global.kf5_user_id"),(0,l.default)("global.identity"))},t.cacheIdentity=function(e){var t=e.vid,n=e.kf5_user_id;l.default.set("global.kf5_user_id",n),(0,P.cacheIdentity)(n,t)},t.canStart=function(){p.default.getState().app.canStart||p.default.dispatch(m.default.canStart())},t.toast=function(e){p.default.dispatch(m.default.toastNotice(e))}),C={};try{C.newMessage=function(e){function t(){var e=n.volume;n.volume=0,n.play&&n.play(),n.pause&&n.pause(),n.volume=e,document.removeEventListener("touchend",t,!0)}var n=document.createElement("audio");return n.autoplay=!1,n.controls=!1,n.loop=!1,n.preload="auto",n.src=e,document.addEventListener("touchend",t,!0),function(){n.currentTime=0,n.play&&n.play()}}((0,l.default)("bells").newMessage)}catch(e){}var k=(t.ringBell=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"newMessage",t=C[e];t&&t()},t.setBoxStatus=function(e){if(e!==p.default.getState().app.boxOpened){var t=e?m.default.openBox():m.default.closeBox();p.default.dispatch(t)}},t.changeLang=function(e){e&&"string"==typeof e&&p.default.dispatch(m.default.changeLang(e))},t.setCompany=function(e){p.default.dispatch(h.default.setCompany(e))},t.setChat=function(e){p.default.dispatch(O.default.setChat(e))},t.setAgent=function(e){p.default.dispatch(b.default.setAgent(e))},t.setAgentTyping=function(){p.default.dispatch(b.default.typing())},t.setVisitor=function(e){p.default.dispatch(w.default.setUser(e))},t.displayMessage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=null;if(e.user_id=+e.user_id,I(e.user_id,e.name),"chat.system"===e.type||"im.notify"===e.type)r=M.default.addNotice({id:e.id,content:e.msg,datetime:e.timestamp},t);else{var o=e.upload,i=x(e),u=N(e),s=p.default.getState().user||{},l="chat.custom"===e.type?a(e):{};r=M.default.receiveMessage(e.user_id,{id:e.id,type:e.type,customId:e.custom_id,datetime:e.timestamp,text:A(e),src:o&&o.url,fileName:o&&o.name,fileSize:o&&o.size,recalled:e.recalled,documents:i,questions:u,videoMeeting:l.visitor_url,hotCategories:l.categories},t,!n&&s.id!==e.user_id)}p.default.dispatch(r)});window.displayMessage=k;var x=function(e){if("chat.document"===e.type){var t=e.msg;return e.msg=null,c.base.parseJSON(t)}},N=function(e){if("chat.question"===e.type){var t=e.msg;return e.msg=null,c.base.parseJSON(t)}},A=function(e){var t=e.msg;return"robot"===e.role&&t&&-1!==t.indexOf("{{")&&(t=t.replace(/\{\{([\s|\S]+)\}\}/gi,function(e,t){return'<a action="transferAgent" href="javascript:;">'+t+"</a>"})),t},I=function(e,t){var n=p.default.getState(),r=n.agent,o=n.user,a=n.app;o&&e===o.id||r&&e===r.id||a&&a.users&&Object.keys(a.users).indexOf(e.toString())>-1||D({id:e,name:t})},D=t.stashUser=function(e){p.default.dispatch(m.default.stashUser(e))},F=(t.attachWaves=function(){},t.getUrlOfSwitchToAgent=function(){if(!(0,l.default)("global.livechat"))return"/message";var e=(0,l.default)("global.assignToAgents");return e&&e.length?"/chatbox?agents="+JSON.stringify(e)+"&at="+c.base.now():(0,l.default)("selectAgentGroup.enable")?"/groups":"/chatbox?at="+c.base.now()},t.getUrlOfAppStart=function(){var e=+(0,l.default)("global.self_service_type"),t=(0,l.default)("global.assignToAgents");if(!e){if(!(0,l.default)("global.livechat"))return"/message?back=0";if(t&&t.length)return"/chatbox?agents="+JSON.stringify(t)+"&at="+c.base.now();if((0,l.default)("selectAgentGroup.enable"))return"/groups"}if(1===e){if((0,l.default)("im.enable_robot"))return"/chatbox?robot=1&t="+c.base.now();if(!(0,l.default)("global.livechat"))return"/message?back=0";if(t&&t.length)return"/chatbox?agents="+JSON.stringify(t)+"&at="+c.base.now();if((0,l.default)("selectAgentGroup.enable"))return"/groups"}return 2===e?"/chatbox?search=1":"/chatbox"},t.tryReplyOnTimeout=function(){if((0,l.default)("im.enable_timeout")){var e=(0,l.default)("im.timeout_msg");if(e){F(e);var t=+(0,l.default)("im.timeout"),n=S=setTimeout(function(){if(clearTimeout(n),n===S){var t=p.default.getState(),r=t.agent;r&&"robot"!==r.role&&(e=p.default.getState().app.timeoutMsg)&&p.default.dispatch(M.default.receiveMessage(r.id,{text:e},null,!1))}},1e3*t)}}},t.setTimeoutMsg=function(e){p.default.dispatch(m.default.setTimeoutMsg(e))});t.normalizeQuery=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.agents,n=void 0===t?"":t,r=e.robot,o=void 0!==r&&r,a=e.search,i=void 0!==a&&a,u=e.back,s=void 0===u||u,l=e.at;return n=n?JSON.parse(n):[],o="boolean"==typeof o?o:Boolean(+o),i="boolean"==typeof i?i:Boolean(+i),s="boolean"==typeof s?s:Boolean(+s),{agents:n,robot:o,search:i,back:s,at:l}},t.setVisitingCard=function(e){p.default.dispatch(m.default.setVisitingCard(e))},t.setSession=function(e){p.default.dispatch(m.default.setSession(e))},t.desktopNotifyMessage=function(e){var t=e.text||"",n=void 0;t&&t.length>40&&(t=t.slice(0,40)+"..."),e.src&&(c.base.isImageUrl(e.src)?n=e.src:t="["+e.fileName+"]"),c.base.desktopNotify((0,f.trans)("haveNewMsg"),{icon:(0,l.default)("desktopNotify.icon"),body:t,image:n,tag:"new_message",renotify:!0}).then(function(e){$(e).on("click",function(t){e.close(),window.parent.focus()}),setTimeout(function(){e.close()},(0,l.default)("desktopNotify.time"))}).catch(function(e){return console.error(e)})},t.getTempDataWithSender=function(e){var t={},n=p.default.getState().app.users;if(!n||void 0===n[e])return t;var r=n[e];return t.agent_name=r&&(r.display_name||r.name),t.robot_name=r&&(r.display_name||r.name),t},t.warn=function(e,t){var n=void 0;n="string"==typeof e?e:e.message||e.error&&e.error.message,j(n||t)}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(159),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.display_name=e.display_name||e.name,e.photo=e.photo||e.logo,e.intro=e.intro||e.title,{type:r.Types.SET_COMPANY,payload:e}};t.default={setCompany:o}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getAgentsById=t.patchSessionInfo=t.postSessionInfo=t.getAgentsStatus=t.postVisitorTrack=t.getMessages=t.answerInvitation=t.evaluateChat=t.getVisitorState=t.createOrUpdateVisitor=t.updateUser=t.sendCategoryMessage=t.sendQuestionMessage=t.sendFileMessage=t.sendTextMessage=t.sendMessage=t.typing=t.switchToAgent=t.startChat=t.getSetting=void 0;var o=n(162),a=r(o),i=n(4),u=(r(i),t.getSetting=function(){return a.default.get("settings")},t.startChat=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];return a.default.post("chats",{agent_ids:e,force:t,robot:n,from:r,category_ids:o,forum_ids:i})},t.switchToAgent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return a.default.post("chats/"+e+"/transfer",{agent_ids:t,force:n})},t.typing=function(e){return a.default.post("chats/"+e+"/typing",{typing:!0})},t.sendMessage=function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];return a.default.post("messages",{message:{chat_id:t,id:n,msg:r,type:e,category_ids:o,forum_ids:i}})});u.types={TEXT:"chat.msg",FILE:"chat.upload",QUESTION:"chat.question",CATEGORY:"chat.category"};t.sendTextMessage=_.bind(u,null,u.types.TEXT),t.sendFileMessage=_.bind(u,null,u.types.FILE),t.sendQuestionMessage=_.bind(u,null,u.types.QUESTION),t.sendCategoryMessage=_.bind(u,null,u.types.CATEGORY),t.updateUser=function(e,t){var n=t.name,r=t.email,o=t.phone,i=t.metadata,u=t.notes,s=t.kf5_user_id,l=t.org_id;return a.default.patch("visitors/"+e,{visitor:{display_name:n,email:r,phone:o,metadata:i,notes:u,kf5_user_id:s,org_id:l}})},t.createOrUpdateVisitor=function(e){return a.default.post("visitors",{visitor:e})},t.getVisitorState=function(e){return a.default.get("visitors/"+e+"/chatting")},t.evaluateChat=function(e,t){return a.default.patch("chats/"+e+"/ratting",{chat:t})},t.answerInvitation=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return a.default.post("visitors/"+e+"/inviting",{agent_id:t,accept:+n})},t.getMessages=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a.default.get("messages",{filter:{id:{$lt:e}},page:{number:t.number||0,limit:t.limit||10},sort:{id:n.id||"desc"}})},t.postVisitorTrack=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a.default.patch("visitors/"+e+"/traces",t)},t.getAgentsStatus=function(){return a.default.get("agents/status")},t.postSessionInfo=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a.default.post("sessions",{session:t,chat_id:e})},t.patchSessionInfo=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a.default.patch("sessions/"+e,{session:t})},t.getAgentsById=function(e){return a.default.get("agents/"+e)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),n(163);var o=n(4),a=r(o),i=n(3),u=r(i),s=n(2),l=r(s),c=window.FormData,f=(0,a.default)("http.checkData"),d=(0,a.default)("http.errorHandler"),p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=n;return t=_.toUpper(t),e=u.default.addHostToUrl(e,(0,a.default)("hosts.visitorChatAPI")),r=_.assign({"X-Cookie":u.default.system.uuid(),"X-Company-ID":(0,a.default)("global.company_id"),"X-Lang":l.default.current(),"X-Platform":(0,a.default)("global.isMobile")?"mobile":"web","Content-Type":"application/json"},r),c&&n instanceof c&&delete r["Content-Type"],"application/json"===r["Content-Type"]&&(o=JSON.stringify(n)),"GET"===t&&(e=u.default.addParamsToUrl(e,n),o=void 0),Promise.resolve(fetch(e,{method:t,body:o,headers:r,credentials:"same-origin"})).then(function(e){if(e.status>=200&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t}).then(function(e){return e.json()}).then(f).catch(d)};t.default=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return e?e.message&&/Too Large/i.test(e.message)?(0,c.trans)("uploadError.sizeError"):"ext"===e.type?(0,c.trans)("uploadError.extError"):e:(0,c.trans)("uploadError.unknownError")}Object.defineProperty(t,"__esModule",{value:!0}),t.checkForum_ids=t.getServiceTime=t.getVisitingCard=t.getRecommendPosts=t.search=t.getQuestions=t.leaveMessage=t.getLeaveMessageSetting=t.uploadFileMessage=t.uploadFile=t.getCompany=t.getHosts=void 0;var a=n(162),i=r(a),u=n(4),s=r(u),l=n(345),c=n(2),f=window.FormData;t.getHosts=function(){return i.default.get("/hosts")},t.getCompany=function(){return i.default.get("/company")},t.uploadFile=function(e){var t=(0,l.validateError)(e);if(t)return Promise.reject(t);var n=new f;return n.append("filename",e),i.default.post("/supportbox/upload",n,{"X-CSRF-Token":(0,s.default)("ticketCSRF")}).then(null,function(e){throw o(e)})},t.uploadFileMessage=function(e){return i.default.post("/attachments/upload?qqfile="+e.name,e,{"Content-Type":"application/octet-stream","X-CSRF-Token":(0,s.default)("ticketCSRF")})},t.getLeaveMessageSetting=function(){return i.default.get("/supportbox/GetSetting")},t.leaveMessage=function(e){return i.default.post("/supportbox/ticket",e,{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","X-CSRF-Token":(0,s.default)("ticketCSRF")})},t.getQuestions=function(){return i.default.get("/supportbox/questions")},t.search=function(e){return i.default.get("/supportbox/search",{keyword:e})},t.getRecommendPosts=function(e){return i.default.get("/supportbox/RecommendedPosts",e)},t.getVisitingCard=function(e){return i.default.get("/supportbox/visitingCard",{agent_id:e})},t.getServiceTime=function(){return i.default.get("/servicetimes/now")},t.checkForum_ids=function(e){var t=e.forum_ids,n=void 0===t?[]:t,r=e.user_id,o={};return o.forum_ids=n.join(","),r&&(o.user_id=r,o.with_permission=1),i.default.get("/supportbox/forums",o)}},function(e,t,n){"use strict";function r(e){if("number"==typeof e.size){if(e.size>10485760)return(0,o.trans)("uploadError.sizeLimitError");if(0===e.size)return(0,o.trans)("uploadError.emptyError")}return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.validateError=r;var o=n(2)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=function(e){return e&&e.__esModule?e:{default:e}}(r),a=n(164),i=function(e){return e&&(e.id=+e.id,e.created=+e.created),o.default.system.stashUser(e),function(t){t({type:a.Types.LOG_IN,payload:e})}};t.default={setUser:i}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){h=e}function a(e){return e?"uuid-"+e:"uuid"}function i(e,t){return(0,c.default)(e||(0,d.default)(),t||m)}function u(e){var t=h.get(a(e));return t||(t=i(e),e||v(e,t)),t}function s(e){return(0,c.default)(e,m)}Object.defineProperty(t,"__esModule",{value:!0}),t.cacheIdentity=void 0,t.setCacheAPI=o,t.uvid=i,t.getIdentity=u,t.getNamespace=s;var l=n(348),c=r(l),f=n(158),d=r(f),p=n(91),y=r(p),m="00000001-0002-0003-0004-000000000005",g={expires:3650},h=y.default,v=t.cacheIdentity=function(e,t){h.set(a(e),t,g)}},function(e,t,n){function r(e){var t=[];return e.replace(/[a-fA-F0-9]{2}/g,function(e){t.push(parseInt(e,16))}),t}function o(e){e=unescape(encodeURIComponent(e));for(var t=new Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}function a(e,t,n,a){if("string"==typeof e&&(e=o(e)),"string"==typeof t&&(t=r(t)),!Array.isArray(e))throw TypeError("name must be an array of bytes");if(!Array.isArray(t)||16!=t.length)throw TypeError("namespace must be uuid string or an Array of 16 byte values");var s=i(t.concat(e));return s[6]=15&s[6]|80,s[8]=63&s[8]|128,n||u(s)}var i=n(349),u=n(90);a.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",a.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",e.exports=a},function(e,t,n){"use strict";function r(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:return t^n^r;case 2:return t&n^t&r^n&r;case 3:return t^n^r}}function o(e,t){return e<<t|e>>>32-t}function a(e){var t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var a=unescape(encodeURIComponent(e));e=new Array(a.length);for(var i=0;i<a.length;i++)e[i]=a.charCodeAt(i)}e.push(128);for(var u=e.length/4+2,s=Math.ceil(u/16),l=new Array(s),i=0;i<s;i++){l[i]=new Array(16);for(var c=0;c<16;c++)l[i][c]=e[64*i+4*c]<<24|e[64*i+4*c+1]<<16|e[64*i+4*c+2]<<8|e[64*i+4*c+3]}l[s-1][14]=8*(e.length-1)/Math.pow(2,32),l[s-1][14]=Math.floor(l[s-1][14]),l[s-1][15]=8*(e.length-1)&4294967295;for(var i=0;i<s;i++){for(var f=new Array(80),d=0;d<16;d++)f[d]=l[i][d];for(var d=16;d<80;d++)f[d]=o(f[d-3]^f[d-8]^f[d-14]^f[d-16],1);for(var p=n[0],y=n[1],m=n[2],g=n[3],h=n[4],d=0;d<80;d++){var v=Math.floor(d/20),b=o(p,5)+r(v,y,m,g)+h+t[v]+f[d]>>>0;h=g,g=m,m=o(y,30)>>>0,y=p,p=b}n[0]=n[0]+p>>>0,n[1]=n[1]+y>>>0,n[2]=n[2]+m>>>0,n[3]=n[3]+g>>>0,n[4]=n[4]+h>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]}e.exports=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(2),a=function(){r.system.canStart(),r.system.setBoxStatus(!0),r.base.postToParent("CMD::showSupportbox")},i=function(){r.system.setBoxStatus(!1),r.base.postToParent("CMD::hideSupportbox")},u=function(e){var t=e.id,n=e.name,a=e.photo,i=r.base.stringify({title:n,content:(0,o.trans)("inviteChat.greeting"),avatar:a,submitText:(0,o.trans)("inviteChat.submit"),cancelText:(0,o.trans)("inviteChat.reject"),data:{agentId:t}});r.base.postToParent("CMD::kf5Notice "+i)},s=function(e){e="number"==typeof e?e:0,r.base.postToParent("CMD::newMsgCountNotice "+e)},l=function(e,t){var n=r.base.stringify({url:e,name:t});r.base.postToParent("CMD::showImage "+n)};t.default={showBox:a,hideBox:i,notifyInvitation:u,notifyNewMsgCount:s,showImage:l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enhanceEvent=void 0;var r=n(352),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.enhanceEvent=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=function(){return function(e){return function(t,n,o){var a=void 0,i=e(t,n,o),u=function(e){a=e&&e.type,i.dispatch(e)},s=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if("function"==typeof e?(n=t,t=e,e=null):e&&!n&&(n=t,t=null),!e&&"function"!=typeof t)throw new TypeError("Expected predicate to be a function.");if("function"!=typeof n)throw new TypeError("Expected callback to be a function.");var o=void 0,u=!1,s=i.getState(),l=function(n){return e?e===a&&(!t||t.call(null,s,n)):t.call(null,s,n)};return o=i.subscribe(function(){var e=i.getState();if(l(e)){var t=s;if(r){if(u)return;o&&o()}u=!0,s=e,n.call(null,t,e)}else s=e})};return r({},i,{dispatch:u,once:function(e,t,n){return s(e,t,n,!0)},on:s})}}};t.default=o},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l,c,f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,r)}if("value"in o)return o.value;var i=o.get;if(void 0!==i)return i.call(r)},p=n(0),y=r(p),m=n(89),g=(r(m),n(13)),h=n(2),v=(r(h),n(4)),b=r(v),_=n(3),w=r(_),E=n(378),O=r(E),T=n(65),M=r(T),P=n(379),S=r(P),j=n(380),C=r(j),k=n(381),x=r(k),N=n(383),A=r(N),I=n(384),D=r(I),F=n(385),L=r(F),R=n(387),U=r(R),B=(0,b.default)("global.show_copyright"),q=(u=(0,g.connect)(function(e){return{lang:e.app.lang,toast:e.app.toast,visitingCard:e.app.visitingCard,agent:e.agent,company:e.company}}))((c=l=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.query=function(){var t=e.props.location.query;return w.default.system.normalizeQuery(t)},e.toggleLoading=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.setState(function(e){return"boolean"!=typeof t&&(t=!e.loading.show),{loading:{show:t,cover:n}}})},e.toggleBackBtn=function(t){e.setState(function(e){return"boolean"!=typeof t&&(t=!e.showBack),{showBack:t}})},e.slideUpHeader=function(){e.$header.removeClass("show"),e.adjustBody()},e.slideDownHeader=function(){e.$header.addClass("show"),e.adjustBody()},e.adjustBody=function(){$(e.body).css("top",e.$header.height()||0)},e.showChatInput=function(){e.setState({showChatInput:!0,bodyHeight:B?N.heights.HEIGHT_WITH_INPUT_AND_COPYRIGHT:N.heights.HEIGHT_WITH_INPUT})},e.closeChatInput=function(){e.setState({showChatInput:!1,bodyHeight:B?N.heights.HEIGHT_WITH_COPYRIGHT:N.heights.HEIGHT_DEFAULT})},e.showAgentOnHeader=function(){e.setState({dataTypeOfHeader:"agent"})},e.showCompanyOnHeader=function(){e.setState({dataTypeOfHeader:"company"})},e.state={loading:{show:!0,cover:!0},showBack:!1,showChatInput:!1,bodyHeight:N.heights.HEIGHT_WITH_COPYRIGHT,dataTypeOfHeader:null},e}return i(t,e),f(t,[{key:"componentDidMount",value:function(){var e=this;d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),this.$header=$(".support-header"),this.body=".support-body",this.adjustBody(),$(document).on("click",this.body,function(){e.slideUpHeader()}).on("click",".support-header_content_base",function(){e.slideDownHeader()})}},{key:"componentWillUnmount",value:function(){this.$header=null,this.body=null}},{key:"isChat",value:function(){return"/chatbox"===this.props.location.pathname}},{key:"getAgentForHeader",value:function(){var e=this.props,t=e.agent,n=e.company,r=this.state.dataTypeOfHeader;return"agent"===r?t:"company"===r?n:t}},{key:"render",value:function(){var e=this.props,t=this.state;return y.default.createElement("div",{className:"kf5-chat"},y.default.createElement("div",{className:"kf5-chat-support-box"+(t.showBack?" sub-page":"")+(B?"":" no-contact")},t.loading.show&&(t.loading.cover?y.default.createElement(O.default,null,y.default.createElement(M.default,{center:!0})):y.default.createElement(M.default,{center:!0})),y.default.createElement(C.default,null),t.showBack&&y.default.createElement(S.default,null),y.default.createElement("div",{className:"kf5-chat-support-box_scroll"},y.default.createElement("div",{className:"kf5-chat-support-box_scroll_inner"},y.default.createElement("div",{className:"scroll_mousewheel"+(this.isChat()?" chat-page":"")},(0,b.default)("global.isMobile")?"":y.default.createElement(x.default,{agent:this.getAgentForHeader(),company:e.company,visitingCard:e.visitingCard}),y.default.createElement(A.default,{ref:"body",height:t.bodyHeight},e.children&&y.default.cloneElement(e.children,{root:{query:this.query,toggleLoading:this.toggleLoading,toggleBackBtn:this.toggleBackBtn,slideUpHeader:this.slideUpHeader,showChatInput:this.showChatInput,closeChatInput:this.closeChatInput,showAgentOnHeader:this.showAgentOnHeader,showCompanyOnHeader:this.showCompanyOnHeader}}))),y.default.createElement("div",{className:"support-foot"},t.showChatInput&&y.default.createElement(U.default,null),B&&y.default.createElement(D.default,null)))),y.default.createElement(L.default,{content:e.toast})))}}]),t}(y.default.Component),l.propTypes={children:y.default.PropTypes.element},s=c))||s;t.default=q},function(e,t,n){"use strict";function r(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=function(e){var t=e.children,n=r(e,["children"]);return a.default.createElement("div",{style:n},t)};i.defaultProps={position:"absolute",zIndex:1e4,left:0,top:0,width:"100%",height:"100%",background:"#fff"},t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r),a=n(2),i=n(39),u=function(){i.history.goBack()},s=function(e){return o.default.createElement("a",{className:"kf5-chat-back waves-light",title:(0,a.trans)("back"),onClick:u})};t.default=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=n(0),d=r(f),p=n(13),y=n(2),m=n(3),g=r(m),h=n(61),v=r(h),b=(u=(0,p.connect)(function(e){return{lang:e.app.lang,bellEnabled:e.app.bellEnabled}},c({},v.default)))(s=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.toggleSound=function(){e.props.bellEnabled?e.props.disableBell():e.props.enableBell()},e.packUp=function(){g.default.cmd.hideBox()},e.openNewWindow=function(){g.default.cmd.hideBox(),window.open(window.location.href,"_blank","width=620,height=590,toolbar=no,menubar=no,location=0,status=0,directories=0,scrollbars=1")},e}return i(t,e),l(t,[{key:"render",value:function(){var e=this.props.bellEnabled,t=e?(0,y.trans)("soundCloseTitle"):(0,y.trans)("soundOpenTitle"),n=g.default.inIFrame();return d.default.createElement("div",{className:"support-header_tool"},n&&d.default.createElement("a",{className:"support-header-tool_close waves-light",title:(0,y.trans)("packUp"),onClick:this.packUp},(0,y.trans)("packUp")),d.default.createElement("a",{className:"support-header-tool_sound waves-light"+(e?"":" toggle"),title:t,onClick:this.toggleSound},t),n&&d.default.createElement("a",{className:"support-header-tool_max waves-light",title:(0,y.trans)("newWindowOpenTitle"),onClick:this.openNewWindow},(0,y.trans)("newWindowOpenTitle")))}}]),t}(d.default.Component))||s;t.default=b},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(){$(".support-body").css("top",$(".support-header").height()||0)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s,l,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(0),d=r(f),p=n(2),y=n(180),m=r(y),g=n(382),h=r(g),v={background:"#f9f9f9",fontSize:"18px",textAlign:"center",lineHeight:"40px"},b=(l=s=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),c(t,[{key:"componentDidUpdate",value:function(){window.kf5_head_scroll.h=$(".support-header").outerHeight()-80,u()}},{key:"componentDidMount",value:function(){u()}},{key:"render",value:function(){var e=this.props,t=e.company,n=e.agent,r=e.visitingCard,o=!!n&&!!n.typing;t=t||{},n=n||t;var a=n.display_name||n.name;return d.default.createElement("div",{className:"support-header"},d.default.createElement("div",{className:"support-header_content"},r&&d.default.createElement(h.default,r),d.default.createElement("div",{className:"support-header_content_base"},n.photo?d.default.createElement("img",{src:n.photo,alt:a,className:"support-header_pic"}):d.default.createElement(m.default,{className:"support-header_pic",style:v},a),d.default.createElement("div",{className:"support-header_info"},d.default.createElement("div",{className:"support-header_name",title:a},o?(0,p.trans)("typing"):a),d.default.createElement("div",{className:"support-header_intro"},n.intro||r.short_desc)))))}}]),t}(d.default.Component),s.propTypes={agent:d.default.PropTypes.object,company:d.default.PropTypes.object,visitingCard:d.default.PropTypes.object},l);t.default=b},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r),a=function(e){var t=e.name,n=e.photo,r=e.description,a=e.contacts;return o.default.createElement("div",{className:"support-header_content_more"},o.default.createElement("div",{className:"support-header_content_more_top"},o.default.createElement("img",{src:n,alt:t}),o.default.createElement("h2",{className:""},t)),o.default.createElement("div",{className:"support-header_content_more_info"},r||" "),o.default.createElement("div",{className:"support-header_content_more_social"},a&&a.length?a.map(function(e,t){return i(t,e)}):" "))};a.propTypes={name:o.default.PropTypes.string,photo:o.default.PropTypes.string,description:o.default.PropTypes.string,contacts:o.default.PropTypes.array};var i=function(e,t){var n=t.type,r=t.value,a=void 0;switch(r+="",n){case"qq":return o.default.createElement("a",{key:e,href:"tencent://message/?uin="+r,className:"waves-light social_qq",value:r});case"link":return o.default.createElement("a",{key:e,href:r,target:"_blank",className:"waves-light social_web",value:r});case"email":return o.default.createElement("a",{key:e,href:"mailto:"+r,className:"waves-light social_email",value:r});case"weibo":return a=-1!==r.indexOf("http")?r:"http://weibo.com/"+r,o.default.createElement("a",{key:e,href:a,target:"_blank",className:"waves-light social_weibo",value:r});case"taobao":return a=-1!==r.indexOf("http")?r:"http://"+r+".taobao.com",o.default.createElement("a",{key:e,href:a,target:"_blank",className:"waves-light social_taobao",value:r});default:return null}};t.default=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.heights=void 0;var u,s,l,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(0),d=r(f),p=n(4),y=r(p),m=(n(2),n(65)),g=(r(m),t.heights={HEIGHT_DEFAULT:460,HEIGHT_WITH_INPUT:408,HEIGHT_WITH_COPYRIGHT:436,HEIGHT_WITH_INPUT_AND_COPYRIGHT:384}),h=(s=u=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));l.call(e);var n=e.props;return e.state={blur:n.blur,notify:n.notify},e}return i(t,e),c(t,[{key:"componentDidMount",value:function(){this.$supportBody=$(".support-body"),this.$supportBodyInner=$(".support-body_inner")}},{key:"componentWillUnmount",value:function(){this.$supportBody=null,this.$supportBodyInner=null}},{key:"componentWillReceiveProps",value:function(e){var t=this.props;t.blur!==e.blur&&this.setState({blur:e.blur}),_.isEqual(t.notify,e.notify)||this.setState({notify:e.notify})}},{key:"componentDidUpdate",value:function(){window.kf5_head_scroll.body_h=this.props.height}},{key:"render",value:function(){var e=this.props,t=this.state,n=t.blur,r=t.notify;return d.default.createElement("div",{className:"support-body"+(n?" blur":"")},r.component&&d.default.createElement(r.component,r.props),d.default.createElement("div",{className:"support-body_inner"},e.children&&d.default.cloneElement(e.children,{body:{toggleBlur:this.toggleBlur,notify:this.notify,getScrollDistanceToBottom:this.getScrollDistanceToBottom,scrollToBottom:this.scrollToBottom,scrollToTop:this.scrollToTop,getOverflowHeight:this.getOverflowHeight}})))}}]),t}(d.default.Component),u.defaultProps={height:436,blur:!1,notify:{component:null,props:{}}},u.propTypes={children:d.default.PropTypes.element,height:d.default.PropTypes.oneOf([].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(_.values(g)))),blur:d.default.PropTypes.bool,notify:d.default.PropTypes.shape({component:d.default.PropTypes.element,props:d.default.PropTypes.object})},l=function(){var e=this;this.toggleBlur=function(t){e.setState(function(e){return"boolean"!=typeof t&&(t=!e.blur),{blur:t}})},this.notify=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.setState({blur:!!t,notify:{component:t,props:n}})},this.getScrollDistanceToBottom=function(){var t=e.$supportBody.scrollTop(),n=e.getOverflowHeight();return n?n-t:0},this.scrollToBottom=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200;return new Promise(function(n,r){setTimeout(function(){var o=e.getOverflowHeight();if(!o)return n(null);try{e.$supportBody.animate({scrollTop:o},t,null,function(){n(null)})}catch(e){r(e)}},0)})},this.getOverflowHeight=function(){var t=e.$supportBodyInner.height(),n=(0,y.default)("global.isMobile")?e.$supportBody.height():e.props.height;return t>n?t-n:0},this.scrollToTop=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200;return new Promise(function(n,r){setTimeout(function(){try{e.$supportBody.animate({scrollTop:0},t,null,function(){n(null)})}catch(e){r(e)}},0)})}},s);t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r),a=n(2),i=function(e){return o.default.createElement("div",{className:"foot-contact"},o.default.createElement("a",{href:"http://www.kf5.com/?utm_source=supportbox",target:"_blank"},(0,a.trans)("footerPrompt")))};t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l,c,f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(0),p=r(d),y=n(4),m=r(y),g=n(3),h=r(g),v=n(16),b=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(v),_=n(386),w=r(_),E=(u=(0,w.default)({size:(0,m.default)("toast.limit",5),interval:(0,m.default)("toast.interval",0),willEnqueue:function(e){if(!e||!e.content)throw TypeError("Toast content is required.");h.default.system.toast(null)}}))((c=l=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),f(t,[{key:"componentDidMount",value:function(){this.play()}},{key:"play",value:function(){var e=this.props,t=e.content,n=e.destroy;if(t){var r=(0,m.default)("toast.time",1e3),o=this.refs.toast,a=anime({targets:o,scale:[1.15,1],translateY:["-50%","-50%"],translateX:["-50%","-50%"],opacity:[0,1],autoplay:!1,complete:function(){anime({targets:o,duration:600,delay:r,scale:[1,.8],translateY:["-50%","-50%"],translateX:["-50%","-50%"],easing:"easeInOutExpo",opacity:[1,0],complete:function(){o.style.display="none",n()}})}});$(o).show(0,function(){a.play()})}}},{key:"render",value:function(){return p.default.createElement("div",{ref:"toast",className:"toast"},this.props.content)}}]),t}(p.default.Component),l.propTypes={content:b.id.isRequired},s=c))||s;t.default=E},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),c=r(l),f=n(181),d=r(f),p=0,y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.size,n=void 0===t?3:t,r=e.interval,l=void 0===r?1e3:r,f=e.container,y=e.willEnqueue,m=e.successEnqueue,g=e.failureEnqueue;return"string"==typeof f&&(f={type:f}),f=_.assign({type:"div",props:{},shouldReceiveProps:function(e,t){return!_.isEqual(e,t)}},f),function(e){var t,r;return r=t=function(t){function r(){var e;o(this,r);for(var t=arguments.length,i=Array(t),u=0;u<t;u++)i[u]=arguments[u];var s=a(this,(e=r.__proto__||Object.getPrototypeOf(r)).call.apply(e,[this].concat(i)));return s.enqueue=function(e){var t=_.concat(s.state.queue);t.push(e),s.setState({queue:t})},s.dequeue=function(){var e=_.concat(s.state.queue);e.shift(),s.setState({queue:e})},s.remove=function(e){var t=_.concat(s.state.queue);t[t.indexOf(e)]=void 0,s.setState({queue:t})},s.state={queue:[]},s.lazilyEnqueue=(0,d.default)(s.enqueue,{delay:function(){return _.filter(s.state.queue,function(e){return void 0!==e}).length?l:0},limit:n,dequeue:s.dequeue,will:y,success:m,failure:g}),s}return i(r,t),s(r,[{key:"componentWillReceiveProps",value:function(e){var t=f.shouldReceiveProps;if("function"!=typeof t||t.call(null,this.props,e)){var n=_.assign({key:p++},e);this.lazilyEnqueue(n)}}},{key:"render",value:function(){var t=this,n=this.state.queue,r=_.map(n,function(n,r){return n?c.default.createElement(e,u({},n,{index:r,destroy:function(){return t.remove(n)}}),t.props.children):null});return c.default.createElement(f.type,f.props,r)}}]),r}(c.default.Component),t.displayName="lazyQueue("+(e.name||e.displayName)+")",r}};t.default=y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l,c,f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p=n(0),y=r(p),m=n(29),g=(r(m),n(13)),h=n(18),v=r(h),b=n(4),w=r(b),E=n(3),O=r(E),T=(n(39),n(16)),M=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(T),P=n(61),S=r(P),j=n(38),C=r(j),k=n(101),x=n(388),N=r(x),A=n(389),I=r(A),D=n(390),F=window.File,L=(0,w.default)("global.self_service_type"),R=function(e){return e.stopPropagation(),!1},U=(u=(0,g.connect)(function(e){return{lang:e.app.lang,newMsgCount:e.app.newMsgCount,emojis:e.app.emojis,chat:e.chat,agent:e.agent}},d({},S.default,C.default)))((c=l=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.onClickDocument=function(t){$(t.target).hasClass("control-emoji-list-btn")||e.setState({openEmojiBox:!1})},e.handleEmojiBtnClick=function(){e.setState(function(e){return{openEmojiBox:!e.openEmojiBox}})},e.handleEmojiSelect=function(t,n){e.setState({openEmojiBox:!1}),e.setText(t,!0),$(".chat-textarea-box_input").focus(),n||e.props.usedEmoji(t)},e.handleTextChange=function(t){var n=t.target.value;e.setText(n)},e.handleTextareaKeyDown=function(t){13===t.keyCode&&(t.preventDefault(),t.ctrlKey||t.shiftKey?e.setText("\n",!0):e.handleSend())},e.handleTextareaPaste=function(t){var n=t.clipboardData.items,r=null;$.each(n,function(o,a){"string"===a.kind&&a.getAsString(function(t){if(r){var n=new F([r],t,{type:r.type});e.props.sendMessage(n),r=null}}),"file"===a.kind&&(r=a.getAsFile(),r=new F([r],r.name||"unnamed_"+O.default.now()+".png",{type:r.type||"image/png"}),1===n.length&&(e.props.sendMessage(r),r=null),t.preventDefault())})},e.handleTextareaDrop=function(t){var n=t.dataTransfer.files;$.each(n,function(t,n){e.props.sendMessage(n)}),t.preventDefault(),t.stopPropagation()},e.handleSend=function(){if(!e.isDisableSend()){var t=O.default.analysisMsg(e.state.text);e.props.sendMessage(t),e.setText("")}},e.handleSeeNewMsg=function(){e.props.clearNewMsgCount()},e.setText=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.setState(function(r){var o=n?r.text+t:t;return!o||e.postTyping(),{text:o}})},e.postTyping=function(){e.throttledPostTyping=e.throttledPostTyping||_.throttle(function(){var t=e.props.chat;t&&v.default.typing(t.id)},(0,w.default)("typingValidTime",5e3)),e.throttledPostTyping()},e.state={openEmojiBox:!1,text:""},e}return i(t,e),f(t,[{key:"componentDidMount",value:function(){$(document).on("click",".chat-textarea-face-box",R),$(document).on("click",this.onClickDocument)}},{key:"componentWillUnmount",value:function(){$(document).unbind("click",R),$(document).unbind("click",this.onClickDocument)}},{key:"render",value:function(){var e=this.state.text,t=this.props,n=t.agent,r=t.newMsgCount,o=!!n&&"robot"===n.role,a=o||L&&!n;return y.default.createElement("div",{className:"support-foot_input"},r>0&&y.default.createElement(I.default,{count:r,onClick:this.handleSeeNewMsg}),y.default.createElement("pre",{className:"chat-textarea-box_pre"},e),y.default.createElement(N.default,{value:e,placeholder:o?(0,w.default)("im.input_hint"):"",onChange:this.handleTextChange,onKeyDown:this.handleTextareaKeyDown,onPaste:this.handleTextareaPaste,onDrop:this.handleTextareaDrop}),y.default.createElement("div",{className:"chat-textarea-box_tool"},a?this.renderRobotButtons():this.renderAgentButtons()))}},{key:"renderAgentButtons",value:function(){var e=this.props,t=this.state,n=e.emojis.map(function(e){return e[0]});return[y.default.createElement(D.EmojiSelector,{key:"1",open:t.openEmojiBox,emojis:(0,w.default)("emojis"),frequentlyEmojis:n,onClick:this.handleEmojiBtnClick,onSelect:this.handleEmojiSelect}),this.isDisableSend()?(0,w.default)("ie")?"":y.default.createElement(D.UploadFile,{key:"2"}):y.default.createElement(D.Send,{key:"2",onSend:this.handleSend})]}},{key:"renderRobotButtons",value:function(){return[y.default.createElement(D.TransferAgent,{key:"1",onClick:k.transferAgent}),y.default.createElement(D.Send,{key:"2",onSend:this.handleSend,disabled:this.isDisableSend()})]}},{key:"isDisableSend",value:function(){var e=this.state.text;return!e||/^[\s]*$/.test(e)}}]),t}(y.default.Component),l.propTypes={chat:M.chat,agent:M.agent},s=c))||s;t.default=U},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,u,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),c=function(e){return e&&e.__esModule?e:{default:e}}(l),f=n(2),d=(u=i=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.handleChange=function(t){var n=t.target.value,r=e.props.onChange;e.setState({value:n}),r&&r(t)},e.state={value:e.props.value},e}return a(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({value:e.value})}},{key:"render",value:function(){var e=this.props,t=this.state;return c.default.createElement("textarea",{className:"chat-textarea-box_input",ref:"textarea",autoFocus:e.autoFocus,placeholder:e.placeholder||(0,f.trans)("chatInput.placeholder"),value:t.value,onChange:this.handleChange,onKeyDown:e.onKeyDown,onPaste:e.onPaste,onDrop:e.onDrop,onDragOver:e.onDragOver})}}]),t}(c.default.Component),i.defaultProps={autoFocus:!0,onDragOver:function(e){e.preventDefault(),e.stopPropagation()}},i.propTypes={autoFocus:c.default.PropTypes.bool,value:c.default.PropTypes.string.isRequired,placeholder:c.default.PropTypes.string,onChange:c.default.PropTypes.func,onKeyDown:c.default.PropTypes.func,onPaste:c.default.PropTypes.func,onDrop:c.default.PropTypes.func,onDragOver:c.default.PropTypes.func},u);t.default=d},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,u,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),c=function(e){return e&&e.__esModule?e:{default:e}}(l),f=n(2),d=(u=i=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"componentDidMount",value:function(){window.pop_bottom_in.play({targets:this.refs.newMsg,begin:function(){this.targets.style.display="block"}})}},{key:"render",value:function(){var e=this.props.onClick;return c.default.createElement("a",{ref:"newMsg",href:"javascript:;",className:"has-new-msg",onClick:e},(0,f.trans)("newMsg"))}}]),t}(c.default.Component),i.propTypes={count:c.default.PropTypes.number,onClick:c.default.PropTypes.func},u);t.default=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.TransferAgent=t.UploadFile=t.EmojiSelector=t.Send=void 0;var o=n(391),a=r(o),i=n(392),u=r(i),s=n(398),l=r(s),c=n(399),f=r(c);t.Send=a.default,t.EmojiSelector=u.default,t.UploadFile=l.default,t.TransferAgent=f.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r),a=n(2),i=function(e){return o.default.createElement("div",{className:"chat-textarea-box_tool_item"},o.default.createElement("a",{className:"chat-textarea-box_tool_btn waves-green submit"+(e.disabled?"-off":""),onClick:e.onSend}),o.default.createElement("div",{className:"pop-title"},o.default.createElement("span",null,e.disabled?(0,a.trans)("chatInput.banSend"):(0,a.trans)("chatInput.send"))))};i.defaultProps={disabled:!1},i.propTypes={onSend:o.default.PropTypes.func,disabled:o.default.PropTypes.bool},t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),f=r(c),d=n(4),p=(r(d),n(2)),y=n(393),m=r(y),g=(s=u=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.handleSelectFromFrequentlyUsed=function(t){var n=e.props.onSelect;n&&n(t,!0)},e}return i(t,e),l(t,[{key:"componentDidMount",value:function(){this.props.open&&this.showEmojiBox()}},{key:"componentDidUpdate",value:function(e){this.props.open?e.open||this.showEmojiBox():this.hideEmojiBox()}},{key:"showEmojiBox",value:function(){var e=this.refs.emojiBox;$(e).addClass("show"),window.pop_bottom_in.play({targets:e,begin:function(){this.targets.style.display="block"}})}},{key:"hideEmojiBox",value:function(){var e=$(this.refs.emojiBox);e.hide(),setTimeout(function(){e.removeClass("show")},200)}},{key:"render",value:function(){var e=this.props;return f.default.createElement("div",{className:"chat-textarea-box_tool_item"},f.default.createElement("span",{className:"control-emoji-list-btn chat-textarea-box_tool_btn waves-gray face",onClick:e.onClick}),f.default.createElement("div",{ref:"emojiBox",className:"chat-textarea-face-box"},e.open&&f.default.createElement(m.default,{emojis:e.emojis,onSelect:e.onSelect})),f.default.createElement("div",{className:"pop-title face-box"},f.default.createElement("h4",null,(0,p.trans)("chatInput.emoji")),f.default.createElement(m.default,{emojis:e.frequentlyEmojis,onSelect:this.handleSelectFromFrequentlyUsed})))}}]),t}(f.default.Component),u.defaultProps={open:!1},u.propTypes={open:f.default.PropTypes.bool,emojis:f.default.PropTypes.array,frequentlyEmojis:f.default.PropTypes.array,onClick:f.default.PropTypes.func,onSelect:f.default.PropTypes.func},s);t.default=g},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n(394);var c=n(0),f=r(c),d=n(46),p=r(d),y=(s=u=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.selectEmoji=function(t){var n=null,r=t.target,o=r.nodeName.toLowerCase(),a=e.props.onSelect;"img"===o?n=r.getAttribute("alt"):"a"===o&&(n=r.getAttribute("value")),a&&n&&a(n)},e}return i(t,e),l(t,[{key:"componentDidMount",value:function(){p.default.parse(this.refs.emojis)}},{key:"componentDidUpdate",value:function(e){this.props.emojis.toString()!==e.emojis.toString()&&p.default.parse(this.refs.emojis)}},{key:"render",value:function(){var e=this.props;return f.default.createElement("ul",{ref:"emojis",className:"chat-textarea-face-box_list",onClick:this.selectEmoji},e.emojis.map(function(e,t){return f.default.createElement("li",{key:t},f.default.createElement("a",{href:"javascript:;",value:e},e))}))}}]),t}(f.default.Component),u.propTypes={emojis:f.default.PropTypes.array,onSelect:f.default.PropTypes.func},s);t.default=y},function(e,t,n){var r=n(395);"string"==typeof r&&(r=[[e.i,r,""]]);n(397)(r,{});r.locals&&(e.exports=r.locals)},function(e,t,n){t=e.exports=n(396)(),t.push([e.i,"ul.chat-textarea-face-box_list {\n    text-align: center;\n    width: 272px\n}\n.pop-title ul.chat-textarea-face-box_list {\n    width: 262px;\n}\nul.chat-textarea-face-box_list img.emoji {\n    height: 25px;\n    width: 25px;\n    margin-top: 7px\n}",""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},o=0;o<this.length;o++){var a=this[o][0];"number"==typeof a&&(r[a]=!0)}for(o=0;o<t.length;o++){var i=t[o];"number"==typeof i[0]&&r[i[0]]||(n&&!i[2]?i[2]=n:n&&(i[2]="("+i[2]+") and ("+n+")"),e.push(i))}},e}},function(e,t){function n(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=d[r.id];if(o){o.refs++;for(var a=0;a<o.parts.length;a++)o.parts[a](r.parts[a]);for(;a<r.parts.length;a++)o.parts.push(s(r.parts[a],t))}else{for(var i=[],a=0;a<r.parts.length;a++)i.push(s(r.parts[a],t));d[r.id]={id:r.id,refs:1,parts:i}}}}function r(e){for(var t=[],n={},r=0;r<e.length;r++){var o=e[r],a=o[0],i=o[1],u=o[2],s=o[3],l={css:i,media:u,sourceMap:s};n[a]?n[a].parts.push(l):t.push(n[a]={id:a,parts:[l]})}return t}function o(e,t){var n=m(),r=v[v.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),v.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function a(e){e.parentNode.removeChild(e);var t=v.indexOf(e);t>=0&&v.splice(t,1)}function i(e){var t=document.createElement("style");return t.type="text/css",o(e,t),t}function u(e){var t=document.createElement("link");return t.rel="stylesheet",o(e,t),t}function s(e,t){var n,r,o;if(t.singleton){var s=h++;n=g||(g=i(t)),r=l.bind(null,n,s,!1),o=l.bind(null,n,s,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=u(t),r=f.bind(null,n),o=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=i(t),r=c.bind(null,n),o=function(){a(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}function l(e,t,n,r){var o=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=b(t,o);else{var a=document.createTextNode(o),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(a,i[t]):e.appendChild(a)}}function c(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function f(e,t){var n=t.css,r=t.sourceMap;r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var o=new Blob([n],{type:"text/css"}),a=e.href;e.href=URL.createObjectURL(o),a&&URL.revokeObjectURL(a)}var d={},p=function(e){var t;return function(){return void 0===t&&(t=e.apply(this,arguments)),t}},y=p(function(){return/msie [6-9]\b/.test(self.navigator.userAgent.toLowerCase())}),m=p(function(){return document.head||document.getElementsByTagName("head")[0]}),g=null,h=0,v=[];e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");t=t||{},void 0===t.singleton&&(t.singleton=y()),void 0===t.insertAt&&(t.insertAt="bottom");var o=r(e);return n(o,t),function(e){for(var a=[],i=0;i<o.length;i++){var u=o[i],s=d[u.id];s.refs--,a.push(s)}if(e){n(r(e),t)}for(var i=0;i<a.length;i++){var s=a[i];if(0===s.refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete d[s.id]}}}};var b=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),f=r(c),d=n(3),p=(r(d),n(13)),y=n(2),m=n(38),g=r(m),h=(window.File,(u=(0,p.connect)(function(e){return{lang:e.app.lang}},g.default))(s=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.handleChange=function(t){_.each(t.target.files,function(t){e.props.sendMessage(t)})},e.triggerClick=function(e){$(e.target).find('input[type="file"]').trigger("click")},e}return i(t,e),l(t,[{key:"render",value:function(){return f.default.createElement("div",{className:"chat-textarea-box_tool_item"},f.default.createElement("a",{className:"chat-textarea-box_tool_btn waves-gray file",onClick:this.triggerClick},f.default.createElement("input",{type:"file",className:"chat-textarea-box_tool_btn_file",style:{display:"none"},multiple:!0,onChange:this.handleChange})),f.default.createElement("div",{className:"pop-title"},f.default.createElement("span",null,(0,y.trans)("chatInput.file"))))}}]),t}(f.default.Component))||s);t.default=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),i=n(2),u=n(4),s=r(u),l=(0,s.default)("global.livechat"),c=function(e){var t=e.onClick;return a.default.createElement("div",{className:"chat-textarea-box_tool_item"},a.default.createElement("a",{className:"chat-textarea-box_tool_btn waves-gray human",onClick:t}),a.default.createElement("div",{className:"pop-title"},a.default.createElement("span",null,(0,i.trans)(l?"chatInput.transferToAgent":"chatInput.leaveMsg"))))};c.propTypes={onClick:a.default.PropTypes.func},t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s,l,c,f,d=function(){function e(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),p=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),y=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,r)}if("value"in o)return o.value;var i=o.get;if(void 0!==i)return i.call(r)},m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},g=n(0),h=r(g),v=n(29),b=r(v),w=n(13),E=n(18),O=r(E),T=n(4),M=r(T),P=n(3),S=r(P),j=n(2),C=n(16),k=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(C),x=n(160),N=r(x),A=n(165),I=r(A),D=n(61),F=r(D),L=n(38),R=r(L),U=n(92),B=r(U),q=n(101),G=n(401),H=n(182),z=n(429),V=!1,Q=[],W=0,Y=!0,X=(s=(0,w.connect)(function(e){return{lang:e.app.lang,boxOpened:e.app.boxOpened,newMsgCount:e.app.newMsgCount,users:e.app.users,chat:e.chat,agent:e.agent,user:e.user,messages:e.messages}},m({},F.default,N.default,I.default,R.default)))((f=c=function(e){function t(){a(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));e.clickHandler=function(t){var n=$(t.target);switch(n.data("action")||n.attr("action")){case"transferAgent":var r=S.default.system.getUrlOfSwitchToAgent();e.props.router.push(r);break;case"loadMore":e.handleLoadMore(t);break;case"resend":e.handleResend(t);break;case"retry":e.bootstrap();break;case"leaveMsg":e.props.router.push("/message");break;case"question":e.props.sendMessage({text:n.data("title"),question:n.data("question")});break;case"hotCategory":e.props.sendMessage({text:n.data("title"),category:n.data("category")})}},e.onScroll=_.debounce(function(){e.getScrollDistanceToBottom()<=30&&e.props.newMsgCount&&e.props.clearNewMsgCount()});var n=e.props.body;return e.scrollToBottom=n.scrollToBottom,e.getScrollDistanceToBottom=n.getScrollDistanceToBottom,e.disableComputeNewMsgCount=!1,e.scrollToBottomPromise=null,e}return u(t,e),p(t,[{key:"componentWillMount",value:function(){var e=this.props.root;e.showChatInput(),e.toggleBackBtn(!1),this.closeLoading(),this.resetHeaderData()}},{key:"shouldComponentUpdate",value:function(e){var t=this.props,n=J(t),r=J(e);return!_.isEqual(n,r)||!b.default.is(t.messages,e.messages)}},{key:"componentDidMount",value:function(){y(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),Y=!!this.props.chat,this.bootstrap(),this.initChatBoard(),$(".support-body").on("scroll",this.onScroll).on("click",this.clickHandler)}},{key:"componentDidUpdate",value:function(e){var t=this.props;if(_.isEqual(t.location.query,e.location.query)||(this.resetHeaderData(),this.bootstrap()),!t.newMsgCount&&e.newMsgCount&&this.scrollToBottom(),_.isEqual(t.chat,e.chat)||(t.chat&&(Y=!0),this.initChatBoard(!0)),!b.default.is(t.messages,e.messages)&&(t.root.slideUpHeader(),this.computeAndIncNewMsgCount(e.messages),!t.chat&&this.isLastMsgSendBySelf()&&Y)){Y=!1;var n=S.default.system.getUrlOfAppStart();"/chatbox"===n&&(n+="?at="+S.default.now()),t.router.push(n)}!e.boxOpened&&t.boxOpened&&t.newMsgCount&&t.body.getOverflowHeight()<=20&&(t.clearNewMsgCount(),this.scrollToBottom())}},{key:"componentWillUnmount",value:function(){this.props.root.slideUpHeader(),$(".support-body").unbind("scroll",this.onScroll).unbind("click",this.clickHandler)}},{key:"showLoading",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.props.root.toggleLoading(!0,e)}},{key:"closeLoading",value:function(){this.props.root.toggleLoading(!1)}},{key:"resetHeaderData",value:function(){var e=this.props.root;e.query().search?e.showCompanyOnHeader():e.showAgentOnHeader()}},{key:"bootstrap",value:function(){var e=this,t=this.props,n=t.root,r=t.chat,o=t.setAgent,a=t.setChat,i=t.router,u=n.query(),s=u.agents,l=u.robot,c=u.at,f=u.search,d=(0,M.default)("global.force",!1);if(f)return o(null),void a(null);if(!(r||l||(0,M.default)("global.livechat")&&(0,M.default)("inServiceTime")))return i.replace("/message?back=0");if(!r){this.showLoading();var p=(0,M.default)("global.from"),y=(0,M.default)("global.category_ids"),m=(0,M.default)("global.forum_ids");return O.default.startChat(s,d,l,p,y,m).then(function(e){var t=e.chat,n=void 0===t?null:t,r=e.agent,i=void 0===r?null:r;n&&i&&(o(i),a(n))}).finally(function(){return e.closeLoading()})}return c?(this.showLoading(),O.default.switchToAgent(r.id,s,d).then(null,function(e){e.error&&1301===e.error.code&&S.default.system.toast((0,j.trans)("errors.serviceTimeError")),(0,q.leaveMessage)(!0)}).finally(function(){return e.closeLoading()})):void 0}},{key:"initChatBoard",value:function(){var e=this;if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&V)return this.scrollToBottomPromise=this.scrollToBottom();var t=this.props,n=t.root,r=t.agent,o=t.chat,a=t.messages,i=t.clear,u=t.pushAgentName;if(n.query().search)!V&&this.displayAd(),this.displayRecommendPosts();else if(r&&o)if(a.size){var s=r.display_name||r.name;"robot"!==r.role&&s&&u(s)}else W=0,this.showLoading(),this.pullHistoryMessages(function(t){return t.length?(i(),e.disableComputeNewMsgCount=!0,e.displayHistoryMessages(t),e.displayAd(),e.disableComputeNewMsgCount=!1,e.pullHistoryMessages().then(function(){e.scrollToBottom()})):e.displayAd(),!1}).finally(function(){return e.closeLoading()});V=!0}},{key:"displayAd",value:function(){var e=(0,M.default)("global.show_windows",(0,M.default)("global.show_window",!1)),t=(0,M.default)("global.show_words");e&&t&&this.props.addPostCard({content:t,datetime:-1},{index:0})}},{key:"displayRecommendPosts",value:function(){var e=(0,M.default)("recommendPosts",[]);e&&e.length&&this.props.addDocumentsCard({title:"searchResult.common",documents:e,datetime:-1})}},{key:"pullHistoryMessages",value:function(e){var t=this;return this.props.chat?O.default.getMessages(W).then(function(n){var r=n.messages,o=void 0===r?[]:r,a=n.meta,i=void 0===a?{}:a;return W=o.length?o[o.length-1].id:0,"function"==typeof e&&!1===e(o,i)?n:(o.length&&(Q=o,t.props.unshiftLoadMore()),n)}):Promise.resolve(null)}},{key:"handleLoadMore",value:function(e){var t=this,n=K(e.target);if(n){var r=this.props,o=r.remove,a=r.body;this.showLoading(),o({id:n}),this.pullHistoryMessages(function(){if(!Q.length)return!0;t.displayHistoryMessages(Q)}).then(function(){return a.scrollToTop()}).finally(function(){return t.closeLoading()})}}},{key:"displayHistoryMessages",value:function(e){var t=this;e=_.reverse(e);var n=null,r={index:0,indexInGroup:0};e.forEach(function(e){var o=t.props.messages;if(n){var a=B.default.getIndexList(o,{id:n,offset:1});r.index=a[0],r.indexInGroup=a[1];var i=o.get(a[0]),u="chat.system"!==e.type?+e.user_id:null;B.default.isGroupValidForSender(i,u,e.timestamp)||(r.index+=1,r.indexInGroup=0)}n=e.id,t.props.users&&Object.keys(t.props.users).indexOf(e.user_id.toString())<0&&O.default.getAgentsById(e.user_id).then(function(e){return S.default.system.stashUser(e.agent)}),S.default.system.displayMessage(e,r,!0)})}},{key:"handleResend",value:function(e){var t=K(e.target);if(t){var n=this.props,r=n.messages,o=n.sendMessage,a=n.updateMessage,i=n.remove,u=B.default.getIndexList(r,{id:t}),s=d(u,1),l=s[0];if("number"==typeof l){var c=r.get(l-1);B.default.isGroup(c)&&(c.get("list").forEach(function(e){"failed"!==e.get("status")||"Image"===e.get("component")||e.get("resent")||(o({text:e.get("text"),file:e.get("file")}),a(e.get("id"),{resent:!0}))}),i({id:t}))}}}},{key:"render",value:function(){var e=this,t=this.props;return h.default.createElement("div",{className:"chat-panel"},t.messages.map(function(t){return e.getChildComponent(t)}))}},{key:"getChildComponent",value:function(e,t){var n=this,r=this.props.user,o=e.get("id"),a=e.get("component"),i=m({visitor_name:r&&(r.display_name||r.name)},S.default.system.getTempDataWithSender(t&&t.id));if(e.get("recalled"))return h.default.createElement(z.Notice,{key:o,id:o,data:{content:(0,j.trans)("notifies.withdrawn")}});switch(a){case"Group":return function(){var t=n.props.users,a=void 0===t?{}:t,i=a[e.get("sender")],u=!(!r||!i)&&i.id===r.id;return h.default.createElement(G.Group,{key:o,id:o,user:i,own:u,className:e.get("className")},e.get("list").map(function(e){return n.getChildComponent(e,i)}))}();case"Text":return h.default.createElement(G.Text,{key:o,id:o,status:e.get("status"),error:e.get("error")},e.get("text"));case"Documents":return h.default.createElement(G.Documents,{key:o,id:o,title:(0,j.trans)("robotSearchResult.title",i),documents:e.get("documents")});case"Questions":return h.default.createElement(G.Questions,{key:o,id:o,title:(0,j.trans)("robotSearchResult.title",i),questions:e.get("questions")});case"File":return h.default.createElement(G.File,{key:o,id:o,name:e.get("fileName"),size:e.get("fileSize"),status:e.get("status"),error:e.get("error"),src:e.get("src")});case"Image":return h.default.createElement(G.Image,{key:o,id:o,name:e.get("fileName"),status:e.get("status"),error:e.get("error"),src:e.get("src"),file:e.get("file"),resent:e.get("resent")});case"Notice":return h.default.createElement(z.Notice,{key:o,id:o,type:e.get("type"),data:e.get("data")});case"Datetime":return h.default.createElement(z.Datetime,{key:o,id:o,datetime:e.get("datetime")});case"EvaluateCard":return h.default.createElement(H.EvaluateCard,{key:o,id:o,chatId:e.get("chatId")});case"PostCard":return h.default.createElement(H.PostCard,{key:o,id:o,title:e.get("title"),url:e.get("url"),cover:e.get("cover"),content:e.get("content")});case"VideoMeeting":return h.default.createElement(G.VideoMeeting,{key:o,id:o,url:e.get("videoMeeting")});case"HotCategories":return h.default.createElement(G.HotCategories,{key:o,id:o,title:(0,j.trans)("hotCategories"),categories:e.get("hotCategories")});case"DocumentsCard":return h.default.createElement(H.DocumentsCard,{key:o,id:o,title:(0,j.trans)(e.get("title")),documents:e.get("documents")});case"Answer":return h.default.createElement(G.Answer,{key:o,id:o,status:e.get("status"),error:e.get("error")},e.get("text"));default:throw new Error("component mesages/"+a+" not defined")}}},{key:"computeAndIncNewMsgCount",value:function(e){var t=this;if(!this.disableComputeNewMsgCount){var n=this.props,r=n.messages,o=n.agent,a=B.default.getLast(r);if(a){var i=B.default.getLast(e);if(!b.default.is(i,a)&&(this.props.body.getOverflowHeight()||S.default.inIFrame()&&!this.props.boxOpened)){if(!B.default.isSendBy(r,a.get("id"),o))return this.scrollToBottomPromise=this.scrollToBottom();if(!S.default.inIFrame()||this.props.boxOpened){if(this.scrollToBottomPromise)return this.scrollToBottomPromise.finally(function(){t.canAutoScrollToBottom(e,r)?t.scrollToBottomPromise=t.scrollToBottom():t.props.incNewMsgCount()});if(this.canAutoScrollToBottom(e,r))return this.scrollToBottomPromise=this.scrollToBottom()}this.props.incNewMsgCount()}}}}},{key:"canAutoScrollToBottom",value:function(e,t){var n=0,r=0,o=void 0,a=void 0,i=void 0;if(S.default.isTabHidden())return!1;var u=e.size-1,s=e.get(u),l=t.get(u);if(B.default.isGroup(s)&&B.default.isGroup(l)&&s.get("id")===l.get("id"))for(r=l.get("list").size-s.get("list").size,i=0;i<r;i++)o=l.get("list").get(s.get("list").size+i),(a=o&&o.get("id"))&&(n+=$("#"+a).outerHeight(!0));for(r=t.size-e.size,i=0;i<r;i++)o=t.get(e.size+i),(a=o&&o.get("id"))&&(n+=$("#"+a).outerHeight(!0));var c=this.getScrollDistanceToBottom();return _.floor(n)>=_.floor(c)}},{key:"isLastMsgSendBySelf",value:function(){var e=this.props,t=e.messages,n=e.user,r=B.default.getLast(t);return!!r&&B.default.isSendBy(t,r.get("id"),n)}}]),t}(h.default.Component),c.propTypes={lang:h.default.PropTypes.string,chat:k.chat,agent:k.agent,user:k.visitor,messages:k.messages},l=f))||l;t.default=X;var J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.messages;return o(e,["messages"])},K=function(e){var t=$(e).data("id");if(t)return isNaN(+t)?t:+t}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Answer=t.HotCategories=t.VideoMeeting=t.Questions=t.Documents=t.File=t.Image=t.Text=t.Group=void 0;var o=n(402),a=r(o),i=n(403),u=r(i),s=n(404),l=r(s),c=n(405),f=r(c),d=n(406),p=r(d),y=n(407),m=r(y),g=n(408),h=r(g),v=n(409),b=r(v),_=n(410),w=r(_);t.Group=a.default,t.Text=u.default,t.Image=l.default,t.File=f.default,t.Documents=p.default,t.Questions=m.default,t.VideoMeeting=h.default,t.HotCategories=b.default,t.Answer=w.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l,c,f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(0),p=r(d),y=n(13),m=n(16),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(m),h=n(180),v=r(h),b={width:"34px",height:"34px",lineHeight:"34px",overflow:"hidden",border:"1px solid #efefef",borderRadius:"17px",fontSize:"18px",textAlign:"center",background:"#f9f9f9"},w=(u=(0,y.connect)(function(e){return{lang:e.app.lang}}))((c=l=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),f(t,[{key:"shouldComponentUpdate",value:function(e){return!_.isEqual(this.props,e)}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.own,r=e.user,o=e.className,a=e.lang,i=r&&(r.display_name||r.name),u=p.default.Children.map(e.children,function(e){return p.default.cloneElement(e,{own:n,lang:a,key:e.key})});return p.default.createElement("div",{id:t,className:o||"chat-msg-"+(n?"right":"left")},!n&&r&&p.default.createElement("div",{className:"chat-msg-pic img-user-link",title:i},r.photo?p.default.createElement("img",{src:r.photo,alt:i,className:"img-user"}):p.default.createElement(v.default,{style:b},i)),u)}}]),t}(p.default.Component),l.propTypes={id:g.id.isRequired,user:p.default.PropTypes.object,own:p.default.PropTypes.bool,className:p.default.PropTypes.string},s=c))||s;t.default=w},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,r)}if("value"in o)return o.value;var i=o.get;if(void 0!==i)return i.call(r)},d=n(0),p=r(d),y=n(26),m=r(y),g=n(46),h=r(g),v=n(3),b=r(v),_={whiteSpace:"pre-line"},w=(s=u=function(e){function t(e){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),c(t,[{key:"children",value:function(){var e=this.props.children,t=e||"";try{/<\s*[a|img]/gi.test(t)||(t=b.default.replaceURLToLink(t)),t=h.default.parse(t)}catch(e){console.warn("[Text message] content parse failed",e)}return t+=" ",p.default.createElement("span",{style:_,dangerouslySetInnerHTML:{__html:t}})}},{key:"render",value:function(){return f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this)}}]),t}(m.default),u.propTypes=l({},m.default.propTypes),s);t.default=w},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l,c,f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,r)}if("value"in o)return o.value;var i=o.get;if(void 0!==i)return i.call(r)},y=n(0),m=r(y),g=n(13),h=n(3),v=r(h),b=n(2),_=n(26),w=r(_),E=n(65),O=r(E),T=n(38),M=r(T),P=(u=(0,g.connect)(function(e){return{lang:e.app.lang}},M.default))((c=l=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.handleResend=function(){var t=e.props,n=t.id,r=t.file,o=t.sendMessage,a=t.updateMessage;n&&r&&(o(r),a(n,{resent:!0}))},e.handleShowImage=function(){if(v.default.inIFrame())return v.default.cmd.showImage(e.props.src,e.props.name)},e}return i(t,e),d(t,[{key:"componentDidMount",value:function(){p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),v.default.inIFrame()}},{key:"progressMap",value:function(){var e={initial:null,sending:m.default.createElement(O.default,{size:"sm"}),success:null,failed:m.default.createElement("button",{className:"btn btn-success btn-sm",onClick:this.handleResend},m.default.createElement("i",{className:"icon-replay"}),(0,b.trans)("resend"))};return this.props.resent&&(e.failed=m.default.createElement("span",{className:"chat-msg-wrong",style:{alignSelf:"center"}},(0,b.trans)("sendFailure"))),e}},{key:"children",value:function(){var e=this.props,t=e.src,n=e.name;return m.default.createElement("img",{src:t,alt:n,style:{color:"black",cursor:"pointer"}})}},{key:"render",value:function(){return p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this)}}]),t}(w.default),l.defaultProps=f({},w.default.defaultProps,{className:"chat-msg-text chat-msg-img"}),l.propTypes=f({},w.default.propTypes,{name:m.default.PropTypes.string,src:m.default.PropTypes.string,file:m.default.PropTypes.object,resent:m.default.PropTypes.bool}),s=c))||s;t.default=P},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,r)}if("value"in o)return o.value;var i=o.get;if(void 0!==i)return i.call(r)},d=n(0),p=r(d),y=n(26),m=r(y),g=n(3),h=r(g),v=(s=u=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),c(t,[{key:"children",value:function(){var e=this.props;return[p.default.createElement("a",{key:"0",href:e.src||e.name,className:"chat-msg-file-pic"}),p.default.createElement("div",{key:"1",className:"chat-msg-file-info"},p.default.createElement("h4",null,e.name),p.default.createElement("p",{style:{"font-size":"12px"}},p.default.createElement("span",null,h.default.showFileSize(e.size)),e.error&&p.default.createElement("span",{className:"text-danger"},e.error))),!e.own&&e.src&&p.default.createElement("div",{key:"2",className:"chat-msg-file-down"},p.default.createElement("a",{href:e.src,download:!0,className:"waves-visible waves-green"}))]}},{key:"render",value:function(){return f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this)}}]),t}(m.default),u.defaultProps=l({},m.default.defaultProps,{className:"chat-msg-text chat-msg-file"}),u.propTypes=l({},m.default.propTypes,{name:p.default.PropTypes.string,size:p.default.PropTypes.number,src:p.default.PropTypes.string}),s);t.default=v},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(0),d=r(f),p=n(26),y=r(p),m=(n(2),n(53)),g=r(m),h=(s=u=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),c(t,[{key:"children",value:function(){var e=this.props;return[e.title,d.default.createElement("ul",{key:"1"},e.documents.map(function(e,t){return d.default.createElement("li",{key:e.id},d.default.createElement("a",{target:"_blank",href:e.url},e.title))})),d.default.createElement(g.default,null)]}}]),t}(y.default),u.defaultProps=l({},y.default.defaultProps,{title:"",documents:[]}),u.propTypes=l({},y.default.propTypes,{title:d.default.PropTypes.string,documents:d.default.PropTypes.array}),s);t.default=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(0),d=r(f),p=n(26),y=r(p),m=(n(2),n(53)),g=r(m),h=(s=u=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),c(t,[{key:"children",value:function(){var e=this.props;return[e.title,d.default.createElement("ul",{key:"1"},e.questions.map(function(e,t){return d.default.createElement("li",{key:e.id},d.default.createElement("a",{href:"javascript:;","data-action":"question","data-title":e.title,"data-question":e.id},e.title))})),d.default.createElement(g.default,null)]}}]),t}(y.default),u.defaultProps=l({},y.default.defaultProps,{title:"",questions:[]}),u.propTypes=l({},y.default.propTypes,{title:d.default.PropTypes.string,questions:d.default.PropTypes.array}),s);t.default=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(0),d=r(f),p=n(2),y=n(26),m=r(y),g=(s=u=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),c(t,[{key:"children",value:function(){var e=this.props,t=e.url,n=e.children,r=(0,p.trans)("inviteVideoMeeting",{a_video:"<a href="+(t||n)+' target="_blank">',_a:"</a>"});return d.default.createElement("span",{dangerouslySetInnerHTML:{__html:r}})}}]),t}(m.default),u.propTypes=l({},m.default.propTypes,{url:d.default.PropTypes.string}),s);t.default=g},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){return p.default.createElement("ul",{key:"1"},e.map(function(e,t){return p.default.createElement("li",{key:e.id},p.default.createElement("a",{href:"javascript:;","data-action":"hotCategory","data-title":e.title,"data-category":e.id},e.title))}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s,l,c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(0),p=r(d),y=n(26),m=r(y),g=n(53),h=r(g),v=(l=s=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),f(t,[{key:"children",value:function(){var e=this.props;return[e.title,u(e.categories),p.default.createElement(h.default,null)]}}]),t}(m.default),s.defaultProps=c({},m.default.defaultProps,{title:"",categories:[]}),s.propTypes=c({},m.default.propTypes,{title:p.default.PropTypes.string,categories:p.default.PropTypes.array}),l);t.default=v},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,r)}if("value"in o)return o.value;var i=o.get;if(void 0!==i)return i.call(r)},d=n(0),p=r(d),y=n(26),m=r(y),g=n(46),h=r(g),v=n(3),b=r(v),_=n(53),w=r(_),E={whiteSpace:"pre-line"},O=(s=u=function(e){function t(e){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),c(t,[{key:"children",value:function(){var e=this.props.children,t=e||"";try{/<\s*[a|img]/gi.test(t)||(t=b.default.replaceURLToLink(t)),t=h.default.parse(t)}catch(e){console.warn("[Text message] content parse failed",e)}return t+=" ",[p.default.createElement("span",{style:E,dangerouslySetInnerHTML:{__html:t}}),p.default.createElement(w.default,null)]}},{key:"render",value:function(){return f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this)}}]),t}(m.default),u.propTypes=l({},m.default.propTypes),s);t.default=O},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),i=n(66),u=r(i),s=n(16),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(s),c=function(e){var t=e.id,n=e.url,r=e.cover,o=e.content,i=e.title;n&&i&&(i=a.default.createElement("a",{href:n,target:"_blank"},i));var s=[r?a.default.createElement("div",{key:"0",className:"chat-card_ad_img",style:{backgroundImage:"url("+r+")"}}):null,a.default.createElement("div",{key:"1",className:"chat-card_ad_info",dangerouslySetInnerHTML:{__html:o}})];return n&&(s=a.default.createElement("a",{href:n,target:"_blank",className:"chat-card_ad"},s)),a.default.createElement(u.default,{id:t,title:i},a.default.createElement(u.default.Body,null,s))};c.propTypes={id:l.id.isRequired,title:a.default.PropTypes.string,url:a.default.PropTypes.string,cover:a.default.PropTypes.string,content:a.default.PropTypes.string},t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),f=r(c),d=(n(13),n(18)),p=r(d),y=n(3),m=n(2),g=n(16),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(g),v=n(66),b=r(v),_=n(413),w=r(_),E=n(4),O=r(E),T=(s=u=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.setSatisfyLevel=function(t){e.setState({satisfyLevel:t})},e.getSatisfyLevelInfo=function(){return{0:(0,m.trans)("evaluate.satisfyLevel.disSatisfaction"),1:(0,m.trans)("evaluate.satisfyLevel.satisfaction"),2:(0,m.trans)("evaluate.satisfyLevel.notQuiteSatisfaction"),3:(0,m.trans)("evaluate.satisfyLevel.generalSatisfaction"),4:(0,m.trans)("evaluate.satisfyLevel.basicSatisfaction")}},e.onSubmit=function(){var t=e.state,n=e.props.chatId,r=(0,O.default)("im.disable_repeat_ratting");e.setState({submitting:!0}),p.default.evaluateChat(n,{ratting:+t.satisfyLevel,reason:t.reason,resolved:t.solved}).then(function(){e.setState({submitting:!1,submitted:r}),y.system.toast((0,m.trans)("submitSuccess"))}).catch(function(t){e.setState({submitting:!1,submitted:!1}),y.system.warn(t,(0,m.trans)("submitFailed"))})},e.state={satisfyLevel:1,submitting:!1,submitted:!1,reason:"",solved:0},e}return i(t,e),l(t,[{key:"setReason",value:function(e){this.setState({reason:e.target.value})}},{key:"solvedChange",value:function(e){this.setState({solved:+$("input[name=solved]:checked").val()})}},{key:"render",value:function(){var e=this.props,t=this.state,n=t.submitted||t.submitting,r=this.getSatisfyLevelInfo(),o=128-t.reason.length;return f.default.createElement(b.default,{id:e.id,title:(0,m.trans)("evaluate.title")},f.default.createElement(b.default.Body,null,f.default.createElement(w.default,{setSatisfyLevel:this.setSatisfyLevel,satisfyLevelInfo:r,level:t.satisfyLevel}),f.default.createElement("div",{className:"form_item"},f.default.createElement("div",{className:"form_item_title"},(0,m.trans)("evaluate.yourChoice"),f.default.createElement("span",null,r[t.satisfyLevel]))),(0,O.default)("global.kchat_solved")&&f.default.createElement("div",{className:"form_item form_item_box"},f.default.createElement("div",{className:"form_item_title"},(0,m.trans)("evaluate.isProblemSolved")),f.default.createElement("div",null,f.default.createElement("label",null,f.default.createElement("input",{type:"radio",value:"1",name:"solved",onChange:this.solvedChange.bind(this)}),(0,m.trans)("evaluate.solved")),f.default.createElement("label",null,f.default.createElement("input",{type:"radio",value:"2",name:"solved",onChange:this.solvedChange.bind(this)}),(0,m.trans)("evaluate.unsolved")))),f.default.createElement("div",{className:"form_item"},f.default.createElement("div",{className:"form_item_title"},(0,m.trans)("evaluate.reason"),"(",(0,m.trans)("charLeft",{count:o}),"):",f.default.createElement("textarea",{onChange:this.setReason.bind(this)},t.reason)))),f.default.createElement(b.default.Foot,null,f.default.createElement("button",{onClick:this.onSubmit,className:"btn btn-"+(n?"gray":"success")+" waves-light",disabled:n},(0,m.trans)("submit"),t.submitting?"...":"")))}}]),t}(f.default.Component),u.propTypes={id:h.id.isRequired,chatId:f.default.PropTypes.number.isRequired},s);t.default=T},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return 3===e?[1,3,0]:5===e?[1,4,3,2,0]:[1,0]}Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),i=r(a),u=n(4),s=r(u),l=function(e){return i.default.createElement("label",{onClick:e.setSatisfyLevel.bind(void 0,e.level)},i.default.createElement("input",{type:"radio",name:"radio-"+e.radioId,checked:parseInt(e.level)===parseInt(e.currentLevel)}),e.levelName)},c=function(e){var t=(new Date).getTime(),n=o(s.default.get("im.rate_level_count"));return n=n.map(function(n,r){return i.default.createElement(l,{radioId:t,levelName:e.satisfyLevelInfo[n],level:n,currentLevel:e.level,setSatisfyLevel:e.setSatisfyLevel})}),i.default.createElement("div",{className:"form_items"},i.default.createElement("div",{className:"form_item_box"},n))};t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s,l,c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(0),p=r(d),y=n(66),m=r(y),g=(n(2),n(415)),h=(l=s=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),f(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.hint,r=o(e,["title","hint"]);return p.default.createElement(m.default,{title:t,hint:n},p.default.createElement(g.LeaveMessageForm,r))}}]),t}(p.default.Component),s.propTypes=c({title:p.default.PropTypes.string,hint:p.default.PropTypes.string},g.LeaveMessageForm.propTypes),l);t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LeaveMessageForm=void 0;var r=n(416),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.LeaveMessageForm=o.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),f=r(c),d=n(18),p=r(d),y=n(4),m=r(y),g=n(3),h=r(g),v=n(2),b=n(30),w=r(b),E=n(421),O=(s=u=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.enableSubmit=function(){e.setState({canSubmit:!0})},e.disableSubmit=function(){e.setState({canSubmit:!1})},e.uploadFiles=function(t){return p.default.uploadFileMessage(t).then(function(t){if(t.errors)return Array.isArray(t.errors)&&t.errors.length>0?h.default.system.toast(t.errors[0].message):h.default.system.toast((0,v.trans)("uploadFileFailed"));var n=_.cloneDeep(e.state.attachment);n.push(t.attachment),e.setState({attachment:n})}).catch(function(e){h.default.system.toast((0,v.trans)("uploadFileFailed"))})},e.deleteFile=function(t){var n=_.cloneDeep(e.state.attachment),r=_.map(n,"id").indexOf(t.id);r>-1&&n.splice(r,1),e.setState({attachment:n})},e.submit=function(e){},e.state={canSubmit:!1,attachment:[],settings:{is_email_required:!1,is_phone_required:!1,custom_field:[]}},e}return i(t,e),l(t,[{key:"componentDidMount",value:function(){var e=this;p.default.getLeaveMessageSetting().then(function(t){e.setState({settings:t})})}},{key:"render",value:function(){var e=this.props,t=this.state;return f.default.createElement(w.default.Form,{className:"chat-card_form",onValidSubmit:e.onValidSubmit,onValid:this.enableSubmit,onInvalid:this.disableSubmit},f.default.createElement("div",{className:"chat-card_body"},f.default.createElement(E.Input,{name:"TicketForm[name]",title:(0,v.trans)("leaveMsgForm.nameTitle"),value:(0,m.default)("global.name",""),required:!0}),t.settings.is_email_required&&f.default.createElement(E.Input,{name:"TicketForm[requester]",title:(0,v.trans)("leaveMsgForm.email.title"),value:(0,m.default)("global.email",""),required:!0,validations:"isEmail",validationError:(0,v.trans)("leaveMsgForm.email.invalidFormat")}),t.settings.is_phone_required&&f.default.createElement(E.Input,{name:"TicketForm[phone]",title:(0,v.trans)("leaveMsgForm.mobile.title"),value:(0,m.default)("global.phone",""),required:!0}),this.renderCustomFields(),f.default.createElement(E.Textarea,{name:"TicketForm[content]",title:(0,v.trans)("leaveMsgForm.content.title"),value:"",required:!0,validations:"maxLength:200",validationErrors:{maxLength:(0,v.trans)("leaveMsgForm.content.exceedMaxLength",{max_length:200})}}),f.default.createElement(E.Upload,{name:"TicketForm[attachments]",onChange:this.uploadFiles,attachment:this.state.attachment,onDelete:this.deleteFile})),f.default.createElement("div",{className:"chat-card_foot"},f.default.createElement("button",{type:"submit",className:"btn btn-success waves-light",disabled:!t.canSubmit},(0,v.trans)("submit"))))}},{key:"renderCustomFields",value:function(){var e=this.state.settings||{},t=e.custom_field||[];return t.length?t.map(function(e){var t=e.type,n=e.id,r=e.title,o=e.enduser_required,a=e.enduser_title,i=e.items,u=void 0===i?[]:i;return"text"===t?f.default.createElement(E.Input,{key:n,name:"TicketForm[field_"+n+"]",title:r,value:"",required:!!+o}):"dropdownlist"===t?f.default.createElement(E.Select,{key:n,name:"TicketForm[field_"+n+"]",title:a,required:!!+o},f.default.createElement("option",{value:""},(0,v.trans)("leaveMsgForm.select")," "),u.map(function(e,t){return f.default.createElement("option",{key:t,value:e.value},e.key)})):"textarea"===t?f.default.createElement(E.Textarea,{key:n,name:"TicketForm[field_"+n+"]",title:r,value:"",required:!!+o}):null}):null}}]),t}(f.default.Component),u.defaultProps={onValidSubmit:h.default.noop},u.propTypes={onValidSubmit:f.default.PropTypes.func},s);t.default=O},,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Upload=t.CheckboxGroup=t.RadioGroup=t.Textarea=t.Select=t.Input=void 0;var o=n(422),a=r(o),i=n(423),u=r(i),s=n(424),l=r(s),c=n(425),f=r(c),d=n(426),p=r(d),y=n(427),m=r(y);t.Input=a.default,t.Select=u.default,t.Textarea=l.default,t.RadioGroup=f.default,t.CheckboxGroup=p.default,t.Upload=m.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l,c,f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p=n(0),y=r(p),m=n(67),g=r(m),h=n(30),v=(u=(0,h.Decorator)())((c=l=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.handleChange=function(t){var n=t.target.value;e.props.setValue(n),e.props.onChange&&e.props.onChange(n)},e}return i(t,e),d(t,[{key:"render",value:function(){var e=this.props,t=e.getErrorMessages().join(",");return y.default.createElement(g.default,{title:e.title,required:e.isRequired()},y.default.createElement("input",{name:e.name,type:e.type,value:e.getValue(),onChange:this.handleChange}),y.default.createElement("p",{className:"hint text-danger"},t))}}]),t}(y.default.Component),l.defaultProps={type:"text"},l.propTypes=f({},g.default.propsTypes,{type:y.default.PropTypes.oneOf(["text","password","number"]),onChange:y.default.PropTypes.func}),s=c))||s;t.default=v},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l,c,f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p=n(0),y=r(p),m=n(67),g=r(m),h=n(30),v=(u=(0,h.Decorator)())((c=l=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.handleChange=function(t){var n=t.target.value;e.props.setValue(n),e.props.onChange&&e.props.onChange(n)},e}return i(t,e),d(t,[{key:"render",value:function(){var e=this.props,t=e.getErrorMessages().join(",");return y.default.createElement(g.default,{title:e.title,required:e.isRequired()},y.default.createElement("select",f({name:e.name,value:e.getValue(),onChange:this.handleChange},e.multiple?{multiple:!0}:{}),e.children),y.default.createElement("p",{className:"hint text-danger"},t))}}]),t}(y.default.Component),l.defaultProps={multiple:!1},l.propTypes=f({},g.default.propsTypes,{multiple:y.default.PropTypes.bool,onChange:y.default.PropTypes.func}),s=c))||s;t.default=v},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l,c,f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p=n(0),y=r(p),m=n(67),g=r(m),h=n(30),v=(u=(0,h.Decorator)())((c=l=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.handleChange=function(t){var n=t.target.value;e.props.setValue(n),e.props.onChange&&e.props.onChange(n)},e}return i(t,e),d(t,[{key:"render",value:function(){var e=this.props,t=e.getErrorMessages().join(",");return y.default.createElement(g.default,{title:e.title,required:e.isRequired()},y.default.createElement("textarea",{name:e.name,value:e.getValue(),onChange:this.handleChange}),y.default.createElement("p",{className:"hint text-danger"},t))}}]),t}(y.default.Component),l.propTypes=f({},g.default.propsTypes,{onChange:y.default.PropTypes.func}),s=c))||s;t.default=v},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u,s,l,c,f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p=n(0),y=r(p),m=n(184),g=r(m),h=n(30),v=function(e){return y.default.createElement("label",null,y.default.createElement("input",d({type:"radio",name:e.name,value:e.value},e.checked?{defaultChecked:!0}:{},{onClick:e.onClick})),e.title||e.value)};v.propTypes={name:y.default.PropTypes.string,value:y.default.PropTypes.oneOfType([y.default.PropTypes.string,y.default.PropTypes.number]).isRequired,title:y.default.PropTypes.oneOfType([y.default.PropTypes.string,y.default.PropTypes.number]),checked:y.default.PropTypes.bool};var b=(u=(0,h.Decorator)())((c=l=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),f(t,[{key:"handleClick",value:function(e){var t=this.props;t.getValue()!==e&&(t.setValue(e),t.onChange&&t.onChange(e))}},{key:"render",value:function(){var e=this,t=this.props,n=t.getErrorMessages().join(","),r=t.getValue();return y.default.createElement(g.default,{title:t.title,required:t.isRequired(),errors:n},t.children&&y.default.Children.map(t.children,function(n){return y.default.cloneElement(n,{name:t.name,onClick:e.handleClick.bind(e,n.props.value),checked:r===n.props.value})}))}}]),t}(y.default.Component),l.propTypes=d({},g.default.propTypes,{name:y.default.PropTypes.string.isRequired,onChange:y.default.PropTypes.func}),s=c))||s;b.Radio=v,t.default=b},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u,s,l,c,f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p=n(0),y=r(p),m=n(184),g=r(m),h=n(30),v=function(e){return y.default.createElement("label",null,y.default.createElement("input",d({type:"checkbox",name:e.name,value:e.value},e.checked?{defaultChecked:!0}:{},{onClick:e.onClick})),e.title||e.value)};v.propTypes={name:y.default.PropTypes.string,value:y.default.PropTypes.oneOfType([y.default.PropTypes.string,y.default.PropTypes.number]).isRequired,title:y.default.PropTypes.oneOfType([y.default.PropTypes.string,y.default.PropTypes.number]),checked:y.default.PropTypes.bool};var b=(u=(0,h.Decorator)())((c=l=function(e){function t(e){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),f(t,[{key:"handleClick",value:function(e,t){var n=this.props,r=t.target.checked,o=this.getValues();r?o.push(e):o=o.filter(function(t){return t!==e}),n.setValue(o),n.onChange&&n.onChange(o)}},{key:"getValues",value:function(){var e=this.props.getValue();return $.isArray(e)?e:[e]}},{key:"render",value:function(){var e=this,t=this.props,n=t.getErrorMessages().join(","),r=this.getValues();return y.default.createElement(g.default,{title:t.title,required:t.isRequired(),errors:n},t.children&&y.default.Children.map(t.children,function(n){return y.default.cloneElement(n,{name:t.name,onClick:e.handleClick.bind(e,n.props.value),checked:-1!==r.indexOf(n.props.value)})}))}}]),t}(y.default.Component),l.propTypes=d({},g.default.propTypes,{onChange:y.default.PropTypes.func}),s=c))||s;b.Checkbox=v,t.default=b},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),l=r(s),c=n(2),f=n(3),d=r(f),p=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.onDelete=function(t){e.props.onDelete(t)},e.triggerClick=function(e){$(e.target).nextAll("[type='file']").trigger("click")},e.uploadFile=function(t){var n=e,r=d.default.responsibilityPatton(t.target.files[0]);e.setState({errorMessage:"",uploading:!0}),r.after(e.checkFileFormatting).after(e.checkFileSize).after(function(e){n.props.onChange(e).finally(function(){n.setState({uploading:!1})})}),r.trigger()},e.checkFileFormatting=function(t,n){if(t.name.match(/\.(zip|rar|doc|docx|word|xls|xlsx|jpg|png)$/i))return n();e.setState({errorMessage:(0,c.trans)("errors.formattingError"),uploading:!1})},e.checkFileSize=function(t,n){if(t.size<2097152)return n();e.setState({errorMessage:(0,c.trans)("errors.maxSizeError"),uploading:!1})},e.state={errorMessage:"",uploading:!1},e}return i(t,e),u(t,[{key:"render",value:function(){var e=this,t=_.map(this.props.attachment,"token");return l.default.createElement("div",{className:"form_upload"},this.props.attachment&&this.props.attachment.map(function(t){return l.default.createElement(y,{file:t,onDelete:e.onDelete})}),l.default.createElement("p",{className:"error"},this.state.errorMessage),this.state.uploading&&l.default.createElement("p",{className:"status"},"上传中..."),l.default.createElement("a",{href:"javascript:void(0);",onClick:this.triggerClick,className:"btn btn-sm btn-form_upload"},(0,c.trans)("uploadFile")),l.default.createElement("input",{type:"file",style:{display:"none"},onChange:this.uploadFile}),l.default.createElement("input",{type:"hidden",name:this.props.name,value:t}))}}]),t}(l.default.Component),y=function(e){return l.default.createElement("p",{className:"form_upload_file"},l.default.createElement("span",{className:"file_name"},e.file.name),l.default.createElement("a",{className:"delete",href:"javascript:void(0);",onClick:function(){return e.onDelete(e.file)}},(0,c.trans)("remove")))};t.default=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),i=n(66),u=r(i),s=n(2),l=n(16),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(l),f=n(53),d=r(f),p=function(e){var t=e.id,n=e.title,r=e.documents,o=!r||!r.length;return o&&(n=null),a.default.createElement(u.default,{id:t,title:n},a.default.createElement(u.default.Body,null,o?a.default.createElement("span",null,(0,s.trans)("searchResult.empty")):a.default.createElement("ul",null,_.map(r,function(e,t){return a.default.createElement("li",{key:e.id||t},a.default.createElement("a",{target:"_blank",href:e.url},e.title))}))),a.default.createElement(u.default.Foot,null,a.default.createElement(d.default,null)))};p.propTypes={id:c.id.isRequired,title:a.default.PropTypes.string,documents:a.default.PropTypes.array},t.default=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Datetime=t.Notice=void 0;var o=n(168),a=r(o),i=n(430),u=r(i);t.Notice=a.default,t.Datetime=u.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),i=n(3),u=(r(i),n(16)),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(u),l=function(e){var t=c(new Date(e)),n=c(new Date);return t.year!==n.year?t.year+"-"+t.month+"-"+t.day+" "+t.hours+":"+t.minutes:t.month!==n.month||t.day!==n.day?t.month+"-"+t.day+" "+t.hours+":"+t.minutes:t.hours+":"+t.minutes},c=function(e){var t=e.getMinutes(),n=e.getHours(),r=e.getDate(),o=e.getMonth()+1,a=e.getFullYear();return t=t<10?"0"+t:t,n=n<10?"0"+n:n,r=r<10?"0"+r:r,o=o<10?"0"+o:o,{minutes:t,hours:n,day:r,month:o,year:a}},f=function(e){var t=e.id,n=e.datetime;return a.default.createElement("div",{id:t,className:"chat-data-time"},l(n))};f.propTypes={id:s.id.isRequired,datetime:a.default.PropTypes.number.isRequired},t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,r)}if("value"in o)return o.value;var i=o.get;if(void 0!==i)return i.call(r)},l=n(0),c=r(l),f=n(4),d=r(f),p=n(2),y=n(185),m=n(434),g=r(m),h=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments)),n=(0,d.default)("selectAgentGroup.groups",[]);return n=n.map(function(e){return{name:e.title,desc:e.description,agents:e.agents||[]}}),e.state={groups:n},e}return i(t,e),u(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.root,n=e.body;t.closeChatInput(),t.toggleBackBtn(!1),t.showCompanyOnHeader(),t.toggleLoading(!1);var r=this.state.groups;_.every(r,function(e){return!e.agents.length})&&n.notify(y.NoAgent)}},{key:"componentDidMount",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),this.props.body.scrollToTop(0)}},{key:"componentWillUnmount",value:function(){this.props.root.slideUpHeader(),this.props.body.notify(!1)}},{key:"render",value:function(){return c.default.createElement("div",null,c.default.createElement("div",{className:"support-title"},(0,p.trans)("selectConsultType")),c.default.createElement(g.default,{groups:this.state.groups}))}}]),t}(c.default.Component);t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.types=void 0;var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r),a=t.types={SUCCESS:"SUCCESS"},i=function(e){var t=e.type,n=e.title,r=e.detail;return o.default.createElement("div",{className:"support-prompt"},"SUCCESS"===t&&o.default.createElement("div",{className:"support-prompt_success"}),o.default.createElement("h3",null,n),o.default.createElement("p",{dangerouslySetInnerHTML:{__html:r}}))};i.propTypes={type:o.default.PropTypes.oneOf([].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(_.values(a)))),title:o.default.PropTypes.string,detail:o.default.PropTypes.string},t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),i=n(62),u=n(2),s=n(4),l=r(s),c={};(0,l.default)("global.chatbox_color")&&(c.background="#"+(0,l.default)("global.chatbox_color"));var f=function(e){return a.default.createElement("div",{className:"support-all-offline"},a.default.createElement("div",{className:"support-all-offline_info"},(0,u.trans)("noAgentsOnline")),a.default.createElement(i.Link,{className:"support-leave-msg waves-light",style:c,to:"/message"},(0,u.trans)("leaveMessageToUs")))};t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),f=r(c),d=n(435),p=r(d),y=(s=u=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),l(t,[{key:"render",value:function(){var e=this.props.groups;return f.default.createElement("ul",{className:"support-list"},e&&e.map(function(e,t){return f.default.createElement(p.default,{name:e.name,desc:e.desc,agents:e.agents,key:t})}))}}]),t}(f.default.Component),u.propTypes={groups:f.default.PropTypes.arrayOf(f.default.PropTypes.shape(p.default.propTypes))},s);t.default=y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l,c,f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(0),p=r(d),y=n(62),m=n(13),g=n(3),h=r(g),v=n(2),b=(u=(0,m.connect)(function(e){return{lang:e.app.lang,chat:e.chat}}))((c=l=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),f(t,[{key:"render",value:function(){var e=this.props,t=e.chat,n=e.name,r=e.desc,o=e.agents,a=JSON.stringify(_.map(o,function(e){return e&&e.id})),i="/message",u=void 0;return o.length&&(i=t?"/chatbox?agents="+a+"&at="+h.default.now():"/chatbox?agents="+a,u=o[0]),p.default.createElement("li",{className:"support-list_item"},p.default.createElement(y.Link,{className:"waves-gray",to:i},o.length?p.default.createElement("i",{className:"chat-type is-chat",title:(0,v.trans)("onlineConsultTitle")}):p.default.createElement("i",{className:"chat-type is-msg",title:(0,v.trans)("leaveMsgConsultTitle")}),p.default.createElement("div",{className:"user-pic-group"},u&&p.default.createElement("img",{src:u.photo,alt:u.name})),p.default.createElement("div",{className:"support-list_item_info"},p.default.createElement("div",{className:"support-list_item_info_title"},n),p.default.createElement("div",{className:"support-list_item_info_intro"},r," "))))}}]),t}(p.default.Component),l.defaultProps={agents:[]},l.propTypes={name:p.default.PropTypes.string.isRequired,desc:p.default.PropTypes.string,agents:p.default.PropTypes.array},s=c))||s;t.default=b},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,s,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,r)}if("value"in o)return o.value;var i=o.get;if(void 0!==i)return i.call(r)},f=n(0),d=r(f),p=n(13),y=n(18),m=r(y),g=n(4),h=r(g),v=n(3),b=n(2),_=n(182),w=n(185),E=(u=(0,p.connect)(function(e){return{lang:e.app.lang,user:e.user}}))(s=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.onSuccess=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.props.body,r=t.data;e.toggleSubmitting(!1),n.notify(w.Status,{type:"SUCCESS",title:(0,b.trans)("leaveMsgSuccess"),detail:r}),n.scrollToTop(0)},e.onFailed=function(t){e.toggleSubmitting(!1),v.system.toast(t.message.replace(/<\s*br\s*\/?>/g,"")||(0,b.trans)("leaveMsgFailed"))},e.toggleSubmitting=function(t){e.setState({submitting:t}),e.props.root.toggleLoading(t)},e.onValidSubmit=function(t){var n=t.TicketForm,r=void 0===n?{}:n,o=e.props,a=o.user,i=(o.root,$(".chat-card_form").serialize());if(!e.state.submitting&&(e.toggleSubmitting(!0),m.default.leaveMessage(i).then(e.onSuccess).catch(e.onFailed),a&&a.id)){var u=r.name,s=void 0===u?"":u,l=r.requester,c=void 0===l?"":l,f=r.phone,d=void 0===f?"":f;m.default.updateUser(a.id,{name:s,emai:c,phone:d})}},e.state={submitting:!1},e}return i(t,e),l(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.root,n=e.body,r=t.query(),o=r.back;t.closeChatInput(),t.toggleBackBtn(o),t.showCompanyOnHeader(),t.toggleLoading(!1),(0,h.default)("global.leavemsg")||n.notify(w.Status,{detail:(0,h.default)("global.leavemsg_closed_hint",(0,b.trans)("leaveMsgClosed"))})}},{key:"componentDidMount",value:function(){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),this.props.body.scrollToTop(0)}},{key:"componentWillUnmount",value:function(){this.props.root.slideUpHeader(),this.props.body.notify(!1)}},{key:"render",value:function(){if(!(0,h.default)("global.leavemsg"))return null;var e=(0,h.default)("global.leavemsg_form_desc",(0,b.trans)("leaveMsgForm.notice"));return d.default.createElement("div",{className:"chat-panel"},d.default.createElement(_.LeaveMessageCard,{title:(0,b.trans)("leaveMsgForm.title"),hint:e,onValidSubmit:this.onValidSubmit}))}}]),t}(d.default.Component))||s;t.default=E},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){return d.default.getSetting().then(function(e){var t=e.setting,n=void 0===t?{}:t;return h.default.set("im",n),n})}function a(){var e=(0,h.default)("global.metadata");return $.isArray(e)&&!e.length&&(e=void 0),e="string"==typeof e?e:b.default.stringify(e),d.default.createOrUpdateVisitor({display_name:(0,h.default)("global.name")||void 0,email:(0,h.default)("global.email")||void 0,phone:(0,h.default)("global.phone")||void 0,metadata:e,notes:(0,h.default)("global.notes")||void 0,kf5_user_id:(0,h.default)("global.kf5_user_id")||void 0,org_id:(0,h.default)("global.organization_id")||void 0}).then(function(e){var t=e.visitor;if(!t)throw new Error("visitor initialize error");return t}).then(function(e){return d.default.getVisitorState(e.id).then(function(e){var t=e.visitor,n=e.chat,r=void 0===n?null:n,o=e.agent,a=void 0===o?null:o;return b.default.system.setVisitor(t),b.default.system.cacheIdentity(t),b.default.system.setAgent(a),b.default.system.setChat(r),t})})}function i(){b.default.inIFrame()&&window.parent.postMessage("CMD::iframeReady","*")}function u(){b.default.inIFrame()&&!(0,h.default)("global.active_in_iframe")||b.default.system.canStart(),I().finally(function(){if(y.default.getState().app.canStart)return L();y.default.once(function(e,t){return t.app.canStart},L)}).catch(function(e){console.warn("The application abnormal startup!",e)})}function s(){setTimeout(function(){b.default.inIFrame()||(location.href="/")},2e3)}Object.defineProperty(t,"__esModule",{value:!0});var l=n(0),c=r(l),f=n(18),d=r(f),p=n(36),y=r(p),m=n(39),g=n(4),h=r(g),v=n(3),b=r(v),w=n(2),E=r(w),O=n(186),T=r(O),M=n(460),P=r(M),S=n(462),j=r(S),C=function(){c.default.Component.prototype.componentDidMount=function(){b.default.system.attachWaves()},c.default.Component.prototype.componentDidUpdate=function(e){b.default.system.attachWaves()}},k=function(){var e=(0,h.default)("global.chatbox_color"),t=(0,h.default)("global.chatbox_bubble_color"),n=(0,h.default)("global.chatbox_text_color"),r=['<style type="text/css">'];e&&r.push("\n    .support-header {background: "+e+"}\n    .has-new-msg {background: "+e+"}\n    .has-new-msg:after {border-top-color: "+e+"}\n    "),t&&r.push("\n    .chat-msg-right .chat-msg-text {background: "+t+"; border-color: "+t+"}\n    .chat-msg-right .chat-msg-text:last-child:before {border-bottom-color: "+t+"}\n    "),n&&r.push("\n    .support-header .support-header_name {color: "+n+"}\n    .support-header .support-header_intro {color: "+n+"}\n    .support-header .support-header_content_more {color: "+n+"}\n    .chat-msg-right .chat-msg-text {color: "+n+"}\n    .has-new-msg {color: "+n+"}\n    "),r.push("</style>"),$("head").append(r.join("\n")),(0,h.default)("global.isMobile")&&$("html").addClass("mobile")},x=function(){E.default.setTempData(j.default),$(E.default).on("change",function(){b.default.system.changeLang(E.default.current())}),_.each(["zh_CN","en"],function(e){var t=n(463)("./"+e).default;E.default.register(e,t)});var e=y.default.getState().app.lang;E.default.use(e)},N=function(){return d.default.getHosts().then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_.each(e,function(e,t){h.default.set("hosts."+t,e)})})},A=function(){d.default.getVisitingCard().then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.visitingCard,n=void 0===t?{}:t;b.default.system.setVisitingCard(n),b.default.system.setCompany({display_name:n.name,photo:n.photo,intro:n.short_desc})})},I=function(){var e=Promise.resolve(null);2==+(0,h.default)("global.self_service_type")&&(0,h.default)("global.is_postlist")&&(e=d.default.getRecommendPosts({postlist_forum:(0,h.default)("global.postlist_forum"),postlist_num:(0,h.default)("global.postlist_num"),postlist_choice:(0,h.default)("global.postlist_choice")}).then(function(e){$.isArray(e)&&e.length&&h.default.set("recommendPosts",e)}));var t=d.default.getQuestions().then(function(e){var t=e.enabled,n=void 0!==t&&t,r=e.questions,o=void 0===r?[]:r;h.default.set("selectAgentGroup",{enable:n,groups:o})}),n=Promise.resolve(null);(0,h.default)("global.servicetime_enabled")&&(n=d.default.getServiceTime().then(function(e){var t=e.servicetimes,n=void 0===t?[]:t,r=_.find(n,function(e){return e&&"im"===e.type});r&&r.enabled&&h.default.set("inServiceTime",r.in_work_time)}));var r=d.default.checkForum_ids({forum_ids:(0,h.default)("global.forum_ids"),user_id:(0,h.default)("global.kf5_user_id")}).then(function(e){var t=e.forums;h.default.set("global.forum_ids",_.map(t,"id"))});return function(){return Promise.all([e,t,n,r])}}(),D=function(){y.default.on(function(e,t){return e.app.newMsgCount!==t.app.newMsgCount},function(e,t){b.default.cmd.notifyNewMsgCount(t.app.newMsgCount)})},F=function(){var e={};y.default.on(function(t,n){return n.chat&&n.chat.id&&!n.chat.session_id&&!e[n.chat.id]},function(t,n){var r=n.chat,o=r.id,a=(r.session_id,window._parentWindowReferrerInfo||{});e[o]=!0,d.default.postSessionInfo(o,{ua:window.navigator.userAgent,ref:a.referrer||"",url:a.url||document.referrer,title:a.title||"",device:"",browser:b.default.getBrowserName(),platform:window.navigator.platform,resolution:window.screen.width+"*"+window.screen.height}).catch(function(){delete e[o]})})};t.default=function(){P.default.start(),i(),C(),k(),x(),A(),D(),F(),R("/"),N().then(function(){return Promise.all([o(),a()])}).finally(function(){T.default.start().once("connect",function(){u()}).once("error",function(e){"string"==typeof e&&e.indexOf("banned")>=0&&(T.default.destroy(),s())})})};var L=function(){if(!(0,h.default)("global.self_service_type")&&!(0,h.default)("inServiceTime"))return R("/message?back=0");if(y.default.getState().chat)return R("/chatbox");var e=b.default.system.getUrlOfAppStart();if("/chatbox"===e)return d.default.getAgentsStatus().then(function(){"offline"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).status&&(e="/message?back=0")}).finally(function(){return R(e)});R(e)},R=function(e){m.history.replace(e)}},,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.visitorBanned=t.agentAssignFailed=t.visitorUpdate=t.imNotify=t.message=t.agentInviting=t.chatRatting=t.agentTyping=t.chatClose=t.visitorQueueIndex=t.visitorQueueSuccess=t.visitorQueueTimeout=t.visitorQueueFailedOffline=t.visitorQueueFailed=t.chatTransfer=t.chatAssigned=void 0;var o=n(18),a=(r(o),n(4)),i=r(a),u=n(3),s=r(u),l=n(36),c=r(l),f=n(38),d=r(f),p=function(e){c.default.dispatch(e)};t.chatAssigned=function(e,t){var n=e.chat,r=e.agent;n&&r&&(s.default.system.setAgent(r),s.default.system.setChat(n))},t.chatTransfer=function(e,t){var n=e.chat,r=e.agent;n&&r&&(s.default.system.setAgent(r),s.default.system.setChat(n))},t.visitorQueueFailed=function(e,t){p(d.default.pushEnqueueFailed(e.reason))},t.visitorQueueFailedOffline=function(e,t){p(d.default.pushEnqueueFailedOffline())},t.visitorQueueTimeout=function(e,t){p(d.default.pushEnqueueTimeout(e.msg))},t.visitorQueueSuccess=function(e,t){setTimeout(function(){var t=c.default.getState(),n=t.agent,r=!n||"robot"===n.role;!e.silent&&r&&p(d.default.pushEnqueueSuccess(e.index+1))},(0,i.default)("chatQueueSuccessDelayShow"))},t.visitorQueueIndex=function(e,t){p(d.default.pushQueueProgress(e.index+1))},t.chatClose=function(e,t){s.default.system.setAgent(null),s.default.system.setChat(null)},t.agentTyping=function(e,t){s.default.system.setAgentTyping()},t.chatRatting=function(e,t){p(d.default.addEvaluateCard(e.chat_id))},t.agentInviting=function(e,t){var n={id:e.agent_id,name:e.agent_name,photo:e.photo};s.default.session.set("invitation",n),s.default.cmd.notifyInvitation(n)},t.message=function(e){e&&"visitor"!==e.role&&"chat.system"!==e.type&&s.default.system.setTimeoutMsg(null),s.default.system.displayMessage(e)},t.imNotify=function(e){s.default.system.displayMessage({type:"im.notify",msg:e.msg})},t.visitorUpdate=function(e,t){s.default.system.setVisitor(e.visitor)},t.agentAssignFailed=function(e,t){p(d.default.pushAgentAssignFailed())},t.visitorBanned=function(e,t){n(186).default.destroy()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=function(e){return e&&e.__esModule?e:{default:e}}(r),a=n(461),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(a),u=$(window),s=function(e){var t=null;if(e&&"string"==typeof e){var n=e.match(/^([^ ]+)(?: +(.*))?/);t=n[1],e=n[2]}return e=o.default.parseJSON(e),{cmd:t,data:e}},l=function(e){if(e){var t=e.split("::");return 2!==t.length?void console.error("[window message]","not support cmd:",e):t[1]}},c=function(e){var t=s(e.originalEvent.data),n=t.cmd,r=t.data,o=l(n);o&&"function"==typeof i[o]&&i[o].call(null,r)},f=function(){d(),u.on("message",c)},d=function(){u.unbind("message",c)};t.default={start:f,destroy:d},u.on("beforeunload",d)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.useLang=t.registerLang=t.toggleIframePanel=t.referrerInfo=t.kf5NoticeRejected=t.kf5NoticeAccepted=t.setAIStore=t.setKnowledgeStore=t.setAgents=t.identify=void 0;var o=n(18),a=r(o),i=n(4),u=r(i),s=n(2),l=r(s),c=n(3),f=r(c),d=n(36),p=r(d),y=n(39);t.identify=function e(t){if(t){t.name&&u.default.set("global.name",t.name),t.email&&u.default.set("global.email",t.email),t.phone&&u.default.set("global.phone",t.phone),t.notes&&u.default.set("global.notes",t.notes),t.metadata&&u.default.set("global.metadata",t.metadata),t.kf5_user_id&&u.default.set("global.kf5_user_id",t.kf5_user_id),t.org_id&&u.default.set("global.organization_id",t.org_id),t.id&&u.default.set("global.identity",t.id);return p.default.getState().user?void 0:p.default.once(function(e,t){return t.user},_.bind(e,null,t))}},t.setAgents=function(e){e&&e.agent_ids&&$.isArray(e.agent_ids)&&(u.default.set("global.assignToAgents",e.agent_ids),u.default.set("global.force",Boolean(e.force)))},t.setKnowledgeStore=function(e){e&&e.category_ids&&$.isArray(e.category_ids)&&u.default.set("global.category_ids",e.category_ids)},t.setAIStore=function(e){e&&e.forum_ids&&$.isArray(e.forum_ids)&&u.default.set("global.forum_ids",e.forum_ids)},t.kf5NoticeAccepted=function(e){f.default.session.remove("invitation");var t=p.default.getState().user;e&&t&&a.default.answerInvitation(t.id,e.agentId,!0).then(function(){y.history.push("/chatbox")})},t.kf5NoticeRejected=function(e){f.default.session.remove("invitation");var t=p.default.getState().user;e&&t&&a.default.answerInvitation(t.id,e.agentId,!1)},t.referrerInfo=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(window._parentWindowReferrerInfo=t,(0,u.default)("global.imTracks",!0)){var n=p.default.getState().user;if(!n)return p.default.once(function(e,t){return t.user},_.bind(e,null,t));var r={},o=!f.default.session.get(n.vid);f.default.session.set(n.vid,f.default.now()),o&&(r={vid:n.vid,browser:f.default.getBrowserName(),ua:window.navigator.userAgent,platform:window.navigator.platform,isMobile:(0,u.default)("global.isMobile"),search_engine:f.default.getSearchEngine(document.referrer),resolution:window.screen.width+"*"+window.screen.height}),r.url=document.referrer,r.referrer_title=t.title,r.ref=t.referrer,r.ref&&(r.search_engine=f.default.getSearchEngine(r.ref)),a.default.postVisitorTrack(n.id,r)}},t.toggleIframePanel=function(e){e&&(e.opened&&f.default.system.canStart(),f.default.system.setBoxStatus(!!e.opened))},t.registerLang=function(e){l.default.register(e.name,e.map)},t.useLang=function(e){l.default.use(e.name)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r='<span style="color: #4078c0;cursor:pointer" data-action="leaveMsg" action="leaveMsg">';t.default={a_:'<span style="color: #4078c0;cursor:pointer" >',_a:"</span>",a_retry:'<span style="color: #4078c0;cursor:pointer" data-action="retry" action="retry">',a_leaveMsg:r,a_leave_msg:'<span style="color: #4078c0;cursor:pointer" data-action="leaveMsg" action="leaveMsg">',a_transfer_agent:'<span style="color: #4078c0;cursor:pointer" data-action="transferAgent" action="transferAgent">'}},function(e,t,n){function r(e){return n(o(e))}function o(e){var t=a[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var a={"./en":199,"./en.js":199,"./zh_CN":200,"./zh_CN.js":200};r.keys=function(){return Object.keys(a)},r.resolve=o,e.exports=r,r.id=463}],[201]);